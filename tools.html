<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TADbit tools &#8212; TADbit 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/forkme_nature.css" />
    <link rel="stylesheet" type="text/css" href="_static/black-on-white.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/TADbit_icon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference Guide" href="reference/index.html" />
    <link rel="prev" title="Modelling a region of the chromatin" href="tutorial/tutorial_11-3D_Models_production_and_analysis.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="reference/index.html" title="Reference Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial/tutorial_11-3D_Models_production_and_analysis.html" title="Modelling a region of the chromatin"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TADbit 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">TADbit tools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tadbit-tools">
<h1>TADbit tools<a class="headerlink" href="#tadbit-tools" title="Permalink to this headline">¶</a></h1>
<p>TADbit also provides a set of command line tools that are installed with
the library and that cover the main functionalities.</p>
<p>This tools are idependent but share a working directory where a local
database is created to store the input/outputs of each process or job,
and also some statistics.</p>
<p>Each of these tools has extensive help, so we will here review only
their general usage and function.</p>
<section id="tadbit-map">
<h2>TADbit map<a class="headerlink" href="#tadbit-map" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">reads</span> <span class="ow">and</span> <span class="n">organize</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">an</span> <span class="n">output</span> <span class="n">working</span> <span class="n">directory</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="nb">map</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">skip_mapping</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="o">--</span><span class="n">fastq</span> <span class="n">PATH</span> <span class="p">[</span><span class="o">--</span><span class="n">fastq2</span> <span class="n">PATH</span><span class="p">]</span> <span class="o">--</span><span class="n">index</span> <span class="n">PATH</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">genome</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]]</span> <span class="o">--</span><span class="n">read</span> <span class="n">INT</span> <span class="o">--</span><span class="n">renz</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmp</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">iterative</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">fast_fragment</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">windows</span> <span class="n">WINDOWS</span> <span class="p">[</span><span class="n">WINDOWS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">species</span> <span class="n">STR</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">descr</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">skip</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">keep_tmp</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mapper</span> <span class="n">STR</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">mapper_binary</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mapper_param</span> <span class="n">MAPPER_PARAM</span> <span class="p">[</span><span class="n">MAPPER_PARAM</span> <span class="o">...</span><span class="p">]]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">skip_mapping</span>           <span class="n">generate</span> <span class="n">a</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">specific</span> <span class="n">quality</span> <span class="n">plot</span> <span class="kn">from</span> <span class="nn">FASTQ</span> <span class="ow">and</span> <span class="n">exits</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">an</span> <span class="n">output</span> <span class="n">folder</span><span class="o">.</span>
  <span class="o">--</span><span class="n">fastq</span> <span class="n">PATH</span>             <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">FASTQ</span> <span class="n">files</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="n">compressed</span> <span class="n">files</span><span class="p">)</span>
  <span class="o">--</span><span class="n">fastq2</span> <span class="n">PATH</span>            <span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">FASTQ</span> <span class="n">file</span> <span class="n">of</span> <span class="n">read</span> <span class="mi">2</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="n">compressed</span> <span class="n">files</span><span class="p">)</span><span class="o">.</span>
                           <span class="n">Needed</span> <span class="k">for</span> <span class="n">fast_fragment</span>
  <span class="o">--</span><span class="n">index</span> <span class="n">PATH</span>             <span class="n">paths</span> <span class="n">to</span> <span class="n">file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">with</span> <span class="n">indexed</span> <span class="n">FASTA</span> <span class="n">files</span> <span class="n">of</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">genome</span><span class="o">.</span>
  <span class="o">--</span><span class="n">genome</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">paths</span> <span class="n">to</span> <span class="n">file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">with</span> <span class="n">FASTA</span> <span class="n">files</span> <span class="n">of</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">genome</span><span class="o">.</span> <span class="n">Needed</span>
                           <span class="k">for</span> <span class="n">fast_fragment</span> <span class="n">mapping</span><span class="o">.</span> <span class="n">If</span> <span class="n">many</span><span class="p">,</span> <span class="n">files</span> <span class="n">will</span> <span class="n">be</span> <span class="n">concatenated</span><span class="o">.</span>
                           <span class="n">I</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="o">--</span><span class="n">genome</span> <span class="n">chr_1</span><span class="o">.</span><span class="n">fa</span> <span class="n">chr_2</span><span class="o">.</span><span class="n">fa</span> <span class="n">In</span> <span class="n">this</span> <span class="n">last</span> <span class="n">case</span><span class="p">,</span> <span class="n">order</span> <span class="ow">is</span>
                           <span class="n">important</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">rest</span> <span class="n">of</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Note</span><span class="p">:</span> <span class="n">it</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">the</span> <span class="n">path</span>
                           <span class="n">to</span> <span class="n">a</span> <span class="n">previously</span> <span class="n">parsed</span> <span class="n">genome</span> <span class="ow">in</span> <span class="n">pickle</span> <span class="nb">format</span><span class="o">.</span>
  <span class="o">--</span><span class="n">read</span> <span class="n">INT</span>               <span class="n">read</span> <span class="n">number</span>
  <span class="o">--</span><span class="n">renz</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>     <span class="n">restriction</span> <span class="n">enzyme</span> <span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Use</span> <span class="s2">&quot;--renz CHECK&quot;</span> <span class="n">to</span> <span class="n">search</span> <span class="k">for</span> <span class="n">most</span>
                           <span class="n">probable</span> <span class="ow">and</span> <span class="n">exit</span><span class="p">;</span> <span class="ow">and</span> <span class="n">use</span> <span class="s2">&quot;--renz NONE&quot;</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">using</span> <span class="n">RE</span> <span class="n">site</span>
                           <span class="n">information</span><span class="o">.</span>
  <span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[</span><span class="n">fasta</span> <span class="n">header</span><span class="p">]</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Used</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">order</span> <span class="k">as</span> <span class="n">data</span><span class="o">.</span>
  <span class="o">--</span><span class="n">tmp</span> <span class="n">PATH</span>               <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">temporary</span> <span class="n">directory</span> <span class="p">(</span><span class="n">default</span> <span class="nb">next</span> <span class="n">to</span> <span class="s2">&quot;workdir&quot;</span> <span class="n">directory</span><span class="p">)</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">skip</span>                   <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="ow">in</span> <span class="n">case</span> <span class="n">already</span> <span class="n">mapped</span><span class="o">.</span>
  <span class="o">--</span><span class="n">keep_tmp</span>               <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="n">keep</span> <span class="n">temporary</span> <span class="n">files</span><span class="o">.</span>

<span class="n">Mapping</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">iterative</span>              <span class="n">default</span> <span class="n">mapping</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="n">fragment</span> <span class="n">based</span> <span class="n">use</span> <span class="n">this</span> <span class="n">flag</span> <span class="k">for</span>
                           <span class="n">iterative</span> <span class="n">mapping</span>
  <span class="o">--</span><span class="n">fast_fragment</span>          <span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="n">use</span> <span class="n">fast</span> <span class="n">fragment</span> <span class="n">mapping</span><span class="o">.</span> <span class="n">Both</span> <span class="n">fastq</span> <span class="n">files</span> <span class="n">are</span> <span class="n">mapped</span> <span class="n">using</span>
                           <span class="n">fragment</span> <span class="n">based</span> <span class="n">mapping</span> <span class="ow">in</span> <span class="n">GEM</span> <span class="n">v3</span><span class="o">.</span> <span class="n">The</span> <span class="n">output</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">intersected</span>
                           <span class="n">read</span> <span class="n">file</span> <span class="n">than</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">directly</span> <span class="ow">in</span> <span class="n">tadbit</span> <span class="nb">filter</span> <span class="p">(</span><span class="n">no</span> <span class="n">tadbit</span>
                           <span class="n">parse</span> <span class="n">needed</span><span class="p">)</span><span class="o">.</span> <span class="n">Access</span> <span class="n">to</span> <span class="n">samtools</span> <span class="ow">is</span> <span class="n">needed</span> <span class="k">for</span> <span class="n">fast_fragment</span> <span class="n">to</span>
                           <span class="n">work</span><span class="o">.</span> <span class="o">--</span><span class="n">fastq2</span> <span class="ow">and</span> <span class="o">--</span><span class="n">genome</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">specified</span> <span class="ow">and</span> <span class="o">--</span><span class="n">read</span> <span class="n">value</span>
                           <span class="n">should</span> <span class="n">be</span> <span class="mf">0.</span>
  <span class="o">--</span><span class="n">windows</span> <span class="n">WINDOWS</span> <span class="p">[</span><span class="n">WINDOWS</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">defines</span> <span class="n">windows</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">trim</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">FASTQ</span> <span class="n">reads</span><span class="p">,</span> <span class="k">for</span>
                           <span class="n">example</span> <span class="n">an</span> <span class="n">iterative</span> <span class="n">mapping</span> <span class="n">can</span> <span class="n">be</span> <span class="n">defined</span> <span class="k">as</span><span class="p">:</span> <span class="s2">&quot;--windows 1:20 1:25</span>
                           <span class="mi">1</span><span class="p">:</span><span class="mi">30</span> <span class="mi">1</span><span class="p">:</span><span class="mi">35</span> <span class="mi">1</span><span class="p">:</span><span class="mi">40</span> <span class="mi">1</span><span class="p">:</span><span class="mi">45</span> <span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="s2">&quot;. But this parameter can also be used for</span>
                           <span class="n">fragment</span> <span class="n">based</span> <span class="n">mapping</span> <span class="k">if</span> <span class="k">for</span> <span class="n">example</span> <span class="n">pair</span><span class="o">-</span><span class="n">end</span> <span class="n">reads</span> <span class="n">are</span> <span class="n">both</span> <span class="ow">in</span> <span class="n">the</span>
                           <span class="n">same</span> <span class="n">FASTQ</span><span class="p">,</span> <span class="k">for</span> <span class="n">example</span><span class="p">:</span> <span class="s2">&quot;--windows 1:50&quot;</span> <span class="p">(</span><span class="k">if</span> <span class="n">the</span> <span class="n">length</span> <span class="n">of</span> <span class="n">the</span>
                           <span class="n">reads</span> <span class="ow">is</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span> <span class="n">Note</span><span class="p">:</span> <span class="n">that</span> <span class="n">the</span> <span class="n">numbers</span> <span class="n">are</span> <span class="n">both</span> <span class="n">inclusive</span><span class="o">.</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">mapper</span> <span class="n">STR</span>             <span class="p">[</span><span class="n">gem</span><span class="p">]</span> <span class="n">mapper</span> <span class="n">used</span><span class="p">,</span> <span class="n">options</span> <span class="n">are</span> <span class="n">gem</span><span class="p">,</span> <span class="n">bowtie2</span> <span class="ow">or</span> <span class="n">hisat2</span>
  <span class="o">--</span><span class="n">mapper_binary</span> <span class="n">STR</span>      <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="n">path</span> <span class="n">to</span> <span class="n">mapper</span> <span class="n">binary</span>
  <span class="o">--</span><span class="n">mapper_param</span> <span class="n">MAPPER_PARAM</span> <span class="p">[</span><span class="n">MAPPER_PARAM</span> <span class="o">...</span><span class="p">]</span>
                           <span class="nb">any</span> <span class="n">parameter</span> <span class="n">that</span> <span class="n">could</span> <span class="n">be</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">GEM</span><span class="p">,</span> <span class="n">BOWTIE2</span> <span class="ow">or</span> <span class="n">HISAT2</span>
                           <span class="n">mapper</span><span class="o">.</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">if</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">proportion</span> <span class="n">of</span> <span class="n">mismatches</span> <span class="n">to</span> <span class="mf">0.05</span>
                           <span class="ow">and</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">indel</span> <span class="n">length</span> <span class="n">to</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="ow">in</span> <span class="n">GEM</span> <span class="n">v2</span> <span class="n">it</span> <span class="n">would</span> <span class="n">be</span><span class="p">:</span> <span class="o">-</span><span class="n">e</span> <span class="mf">0.05</span>
                           <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">big</span><span class="o">-</span><span class="n">indel</span><span class="o">-</span><span class="n">length</span> <span class="mi">10</span><span class="p">),</span> <span class="n">here</span> <span class="n">we</span> <span class="n">could</span> <span class="n">write</span><span class="p">:</span> <span class="s2">&quot;--mapper_param</span>
                           <span class="n">e</span><span class="p">:</span><span class="mf">0.05</span> <span class="nb">max</span><span class="o">-</span><span class="n">big</span><span class="o">-</span><span class="n">indel</span><span class="o">-</span><span class="n">length</span><span class="p">:</span><span class="mi">10</span><span class="s2">&quot;. For BOWTIE2, GEM3 and HISAT2 you</span>
                           <span class="n">can</span> <span class="n">also</span> <span class="k">pass</span> <span class="n">directly</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">enclosed</span> <span class="n">between</span> <span class="n">quotes</span> <span class="n">like</span><span class="p">:</span>
                           <span class="o">--</span><span class="n">mapper_param</span> <span class="s2">&quot;-e 0.05 --alignment-local-min-score 15&quot;</span> <span class="n">IMPORTANT</span><span class="p">:</span>
                           <span class="n">some</span> <span class="n">options</span> <span class="n">are</span> <span class="n">incompatible</span> <span class="k">with</span> <span class="mi">3</span><span class="n">C</span><span class="o">-</span><span class="n">derived</span> <span class="n">experiments</span><span class="o">.</span>

<span class="n">Descriptive</span><span class="p">,</span> <span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">--</span><span class="n">species</span> <span class="n">STR</span>            <span class="n">species</span> <span class="n">name</span>
  <span class="o">--</span><span class="n">descr</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>  <span class="n">extra</span> <span class="n">descriptive</span> <span class="n">fields</span> <span class="n">each</span> <span class="n">filed</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">coma</span><span class="p">,</span> <span class="ow">and</span> <span class="n">inside</span>
                           <span class="n">each</span><span class="p">,</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">value</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">column</span><span class="p">:</span>
                           <span class="o">--</span><span class="n">descr</span><span class="o">=</span><span class="n">cell</span><span class="p">:</span><span class="n">lymphoblast</span><span class="p">,</span><span class="n">flowcell</span><span class="p">:</span><span class="n">C68AEACXX</span><span class="p">,</span><span class="n">index</span><span class="p">:</span><span class="mi">24</span><span class="n">nf</span>
</pre></div>
</div>
</section>
<section id="tadbit-parse">
<h2>TADbit parse<a class="headerlink" href="#tadbit-parse" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Parse</span> <span class="n">mapped</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">reads</span> <span class="ow">and</span> <span class="n">get</span> <span class="n">the</span> <span class="n">intersection</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">parse</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">type</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">read</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mapped1</span> <span class="n">PATHs</span> <span class="p">[</span><span class="n">PATHs</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">mapped2</span> <span class="n">PATHs</span> <span class="p">[</span><span class="n">PATHs</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">renz</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">filter_chrom</span> <span class="n">FILTER_CHROM</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">skip</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">compress_input</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">genome</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">jobids</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">--</span><span class="nb">type</span> <span class="n">STR</span>               <span class="p">[</span><span class="mi">0</span><span class="nb">map</span><span class="p">]</span><span class="n">file</span> <span class="nb">type</span> <span class="n">to</span> <span class="n">be</span> <span class="n">parser</span><span class="p">,</span> <span class="n">MAP</span> <span class="p">(</span><span class="n">GEM</span><span class="o">-</span><span class="n">mapper</span><span class="p">),</span> <span class="n">SAM</span> <span class="ow">or</span> <span class="n">BAM</span>
  <span class="o">--</span><span class="n">read</span> <span class="n">INT</span>               <span class="n">In</span> <span class="n">case</span> <span class="n">only</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">reads</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">parsed</span>
  <span class="o">--</span><span class="n">filter_chrom</span> <span class="n">FILTER_CHROM</span>
                           <span class="n">default</span><span class="p">:</span> <span class="o">--</span><span class="n">filter_chrom</span>
                           <span class="s2">&quot;^(chr)?[A-Za-z]?[0-9]{0,3}[XVI]{0,3}(?:ito)?[A-Z-a-z]?(_dna)?$&quot;</span><span class="p">,</span>
                           <span class="n">regexp</span> <span class="n">to</span> <span class="n">consider</span> <span class="n">only</span> <span class="n">chromosome</span> <span class="n">names</span> <span class="n">passing</span>
  <span class="o">--</span><span class="n">skip</span>                   <span class="p">[</span><span class="n">DEBUG</span><span class="p">]</span> <span class="ow">in</span> <span class="n">case</span> <span class="n">already</span> <span class="n">mapped</span><span class="o">.</span>
  <span class="o">--</span><span class="n">compress_input</span>         <span class="n">Compress</span> <span class="nb">input</span> <span class="n">mapped</span> <span class="n">files</span> <span class="n">when</span> <span class="n">parsing</span> <span class="ow">is</span> <span class="n">done</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">done</span> <span class="ow">in</span>
                           <span class="n">background</span><span class="p">,</span> <span class="k">while</span> <span class="nb">next</span> <span class="n">MAP</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">processed</span><span class="p">,</span> <span class="ow">or</span> <span class="k">while</span> <span class="n">reads</span> <span class="n">are</span>
                           <span class="nb">sorted</span><span class="o">.</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">genome</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">paths</span> <span class="n">to</span> <span class="n">file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">with</span> <span class="n">FASTA</span> <span class="n">files</span> <span class="n">of</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">genome</span><span class="o">.</span> <span class="n">If</span> <span class="n">many</span><span class="p">,</span>
                           <span class="n">files</span> <span class="n">will</span> <span class="n">be</span> <span class="n">concatenated</span><span class="o">.</span> <span class="n">I</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="o">--</span><span class="n">genome</span> <span class="n">chr_1</span><span class="o">.</span><span class="n">fa</span> <span class="n">chr_2</span><span class="o">.</span><span class="n">fa</span> <span class="n">In</span> <span class="n">this</span>
                           <span class="n">last</span> <span class="n">case</span><span class="p">,</span> <span class="n">order</span> <span class="ow">is</span> <span class="n">important</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">rest</span> <span class="n">of</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Note</span><span class="p">:</span> <span class="n">it</span>
                           <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">the</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">previously</span> <span class="n">parsed</span> <span class="n">genome</span> <span class="ow">in</span> <span class="n">pickle</span> <span class="nb">format</span><span class="o">.</span>
  <span class="o">--</span><span class="n">jobids</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>   <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Use</span>
                           <span class="n">tadbit</span> <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span> <span class="n">In</span> <span class="n">this</span> <span class="n">case</span> <span class="n">one</span> <span class="n">jobid</span> <span class="n">can</span> <span class="n">be</span>
                           <span class="n">passed</span> <span class="n">per</span> <span class="n">read</span><span class="o">.</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>

<span class="n">Mapped</span> <span class="n">outside</span> <span class="n">TADbit</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">mapped1</span> <span class="n">PATHs</span> <span class="p">[</span><span class="n">PATHs</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">paths</span> <span class="n">to</span> <span class="n">mapped</span> <span class="n">bam</span> <span class="n">files</span> <span class="p">(</span><span class="n">first</span> <span class="n">read</span><span class="o">-</span><span class="n">end</span><span class="p">)</span>
  <span class="o">--</span><span class="n">mapped2</span> <span class="n">PATHs</span> <span class="p">[</span><span class="n">PATHs</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">paths</span> <span class="n">to</span> <span class="n">mapped</span> <span class="n">bam</span> <span class="n">files</span> <span class="p">(</span><span class="n">second</span> <span class="n">read</span><span class="o">-</span><span class="n">end</span><span class="p">)</span>
  <span class="o">--</span><span class="n">renz</span> <span class="n">STR</span>               <span class="n">restriction</span> <span class="n">enzyme</span> <span class="n">name</span>
</pre></div>
</div>
</section>
<section id="tadbit-filter">
<h2>TADbit filter<a class="headerlink" href="#tadbit-filter" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span> <span class="n">parsed</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">reads</span> <span class="ow">and</span> <span class="n">get</span> <span class="n">valid</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">to</span> <span class="n">work</span> <span class="k">with</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="nb">filter</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">resume</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">apply</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">over_represented</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">strict_duplicates</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">max_frag_size</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">min_frag_size</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">re_proximity</span> <span class="n">NUM</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">mad</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">max_f</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">median</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">pathids</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">compress_input</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">short</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">long</span><span class="p">}]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">valid</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">clean</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">overwrite</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>
  <span class="o">--</span><span class="n">resume</span>                 <span class="n">use</span> <span class="n">filters</span> <span class="n">of</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">pathids</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>  <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="n">under</span> <span class="n">a</span> <span class="n">given</span> <span class="n">pathids</span><span class="o">.</span> <span class="n">Use</span>
                           <span class="n">tadbit</span> <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span> <span class="n">To</span> <span class="nb">filter</span> <span class="n">an</span> <span class="n">intersected</span> <span class="n">file</span>
                           <span class="n">produced</span> <span class="k">with</span> <span class="n">tadbit</span> <span class="nb">map</span> <span class="o">--</span><span class="n">fast_fragment</span> <span class="n">only</span> <span class="n">one</span> <span class="n">PATHid</span> <span class="ow">is</span> <span class="n">needed</span>
                           <span class="n">otherwise</span> <span class="n">one</span> <span class="n">per</span> <span class="n">read</span> <span class="ow">is</span> <span class="n">needed</span><span class="p">,</span> <span class="n">first</span> <span class="k">for</span> <span class="n">read</span> <span class="mi">1</span><span class="p">,</span> <span class="n">second</span> <span class="k">for</span> <span class="n">read</span>
                           <span class="mf">2.</span>
  <span class="o">--</span><span class="n">compress_input</span>         <span class="n">Compress</span> <span class="nb">input</span> <span class="n">mapped</span> <span class="n">files</span> <span class="n">when</span> <span class="n">parsing</span> <span class="ow">is</span> <span class="n">done</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">done</span> <span class="ow">in</span>
                           <span class="n">background</span><span class="p">,</span> <span class="k">while</span> <span class="nb">next</span> <span class="n">MAP</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">processed</span><span class="p">,</span> <span class="ow">or</span> <span class="k">while</span> <span class="n">reads</span> <span class="n">are</span>
                           <span class="nb">sorted</span><span class="o">.</span>
  <span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span>          <span class="n">path</span> <span class="n">samtools</span> <span class="n">binary</span>

<span class="n">Storage</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">short</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">long</span><span class="p">}</span>
                           <span class="p">[</span><span class="mi">0</span><span class="n">mid</span><span class="p">]</span> <span class="k">for</span> <span class="n">compression</span> <span class="n">into</span> <span class="n">pseudo</span><span class="o">-</span><span class="n">BAM</span> <span class="nb">format</span><span class="o">.</span> <span class="n">Short</span> <span class="n">contains</span> <span class="n">only</span>
                           <span class="n">positions</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">mapped</span><span class="p">,</span> <span class="n">mid</span> <span class="n">everything</span> <span class="n">but</span> <span class="n">restriction</span> <span class="n">sites</span><span class="o">.</span>
  <span class="o">--</span><span class="n">valid</span>                  <span class="n">stores</span> <span class="n">only</span> <span class="n">valid</span><span class="o">-</span><span class="n">pairs</span> <span class="n">discards</span> <span class="n">filtered</span> <span class="n">out</span> <span class="n">reads</span><span class="o">.</span>
  <span class="o">--</span><span class="n">clean</span>                  <span class="n">remove</span> <span class="n">intermediate</span> <span class="n">files</span><span class="o">.</span> <span class="n">WARNING</span><span class="p">:</span> <span class="n">together</span> <span class="k">with</span> <span class="nb">format</span> <span class="s2">&quot;short&quot;</span> <span class="ow">or</span>
                           <span class="n">valid</span> <span class="n">options</span><span class="p">,</span> <span class="n">this</span> <span class="n">may</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">losing</span> <span class="n">data</span>

<span class="n">Filtering</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">apply</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">os</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--apply 1 2 3 4 6 7 8 9&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span>
                           <span class="n">numberscorrespond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span>
                           <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span> <span class="n">short</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="n">too</span>
                           <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span> <span class="n">breaks</span>
  <span class="o">--</span><span class="n">over_represented</span> <span class="n">NUM</span>   <span class="p">[</span><span class="mf">0.001</span><span class="o">%</span><span class="p">]</span> <span class="n">percentage</span> <span class="n">of</span> <span class="n">restriction</span><span class="o">-</span><span class="n">enzyme</span> <span class="p">(</span><span class="n">RE</span><span class="p">)</span> <span class="n">genomic</span> <span class="n">fragments</span>
                           <span class="k">with</span> <span class="n">more</span> <span class="n">coverage</span> <span class="n">to</span> <span class="n">exclude</span> <span class="p">(</span><span class="n">possible</span> <span class="n">PCR</span> <span class="n">artifact</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">strict_duplicates</span>      <span class="n">by</span> <span class="n">default</span> <span class="n">reads</span> <span class="n">are</span> <span class="n">considered</span> <span class="n">duplicates</span> <span class="k">if</span> <span class="n">they</span> <span class="n">coincide</span> <span class="ow">in</span>
                           <span class="n">genomic</span> <span class="n">coordinates</span> <span class="ow">and</span> <span class="n">strand</span><span class="p">;</span> <span class="k">with</span> <span class="n">strict_duplicates</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">we</span>
                           <span class="n">also</span> <span class="n">ask</span> <span class="n">to</span> <span class="n">consider</span> <span class="n">read</span> <span class="n">length</span> <span class="p">(</span><span class="n">WARNING</span><span class="p">:</span> <span class="n">this</span> <span class="n">option</span> <span class="ow">is</span> <span class="n">called</span>
                           <span class="n">strict</span><span class="p">,</span> <span class="n">but</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">more</span> <span class="n">permissive</span><span class="p">)</span>
  <span class="o">--</span><span class="n">max_frag_size</span> <span class="n">NUM</span>      <span class="p">[</span><span class="mi">100000</span><span class="p">]</span> <span class="n">to</span> <span class="n">exclude</span> <span class="n">large</span> <span class="n">genomic</span> <span class="n">RE</span> <span class="n">fragments</span> <span class="p">(</span><span class="n">probably</span> <span class="n">resulting</span>
                           <span class="kn">from</span> <span class="nn">gaps</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">reference</span> <span class="n">genome</span><span class="p">)</span>
  <span class="o">--</span><span class="n">min_frag_size</span> <span class="n">NUM</span>      <span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="n">to</span> <span class="n">exclude</span> <span class="n">small</span> <span class="n">genomic</span> <span class="n">RE</span> <span class="n">fragments</span> <span class="p">(</span><span class="n">smaller</span> <span class="n">than</span> <span class="n">sequenced</span>
                           <span class="n">reads</span><span class="p">)</span>
  <span class="o">--</span><span class="n">re_proximity</span> <span class="n">NUM</span>       <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">to</span> <span class="n">exclude</span> <span class="n">read</span><span class="o">-</span><span class="n">ends</span> <span class="n">falling</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RE</span> <span class="n">site</span> <span class="p">(</span><span class="n">pseudo</span><span class="o">-</span>
                           <span class="n">dangling</span><span class="o">-</span><span class="n">ends</span><span class="p">)</span>
  <span class="o">--</span><span class="n">mad</span> <span class="n">NUM</span>                <span class="n">MAD</span> <span class="n">fragment</span> <span class="n">length</span> <span class="n">normally</span> <span class="n">computed</span> <span class="kn">from</span> <span class="nn">observed</span> <span class="n">distribution</span>
  <span class="o">--</span><span class="n">max_f</span> <span class="n">NUM</span>              <span class="n">Maximum</span> <span class="n">fragment</span> <span class="n">length</span> <span class="n">normally</span> <span class="n">computed</span> <span class="kn">from</span> <span class="nn">observed</span> <span class="n">distribution</span>
  <span class="o">--</span><span class="n">median</span> <span class="n">NUM</span>             <span class="n">Median</span> <span class="n">fragment</span> <span class="n">length</span> <span class="n">normally</span> <span class="n">computed</span> <span class="kn">from</span> <span class="nn">observed</span> <span class="n">distribution</span>
</pre></div>
</div>
</section>
<section id="tadbit-normalize">
<h2>TADbit normalize<a class="headerlink" href="#tadbit-normalize" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Normalize</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">generates</span> <span class="n">array</span> <span class="n">of</span> <span class="n">biases</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">normalize</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="o">-</span><span class="n">r</span> <span class="n">INT</span> <span class="p">[</span><span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">max_njobs</span> <span class="n">INT</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">normalize_only</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">normalization</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">biases_path</span> <span class="n">BIASES_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mappability</span> <span class="n">PATH</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">fasta</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">renz</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">factor</span> <span class="n">NUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">prop_data</span> <span class="n">FLOAT</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">seed</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">min_count</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cis_limit</span> <span class="n">CIS_LIMIT</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">trans_limit</span> <span class="n">TRANS_LIMIT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">ratio_limit</span> <span class="n">RATIO_LIMIT</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">--</span><span class="n">cistrans_filter</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">filter_only</span><span class="p">]</span>
                        <span class="p">[</span><span class="o">-</span><span class="n">B</span> <span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="p">[</span><span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">valid</span><span class="p">]</span>

<span class="n">normalize</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">generates</span> <span class="n">array</span> <span class="n">of</span> <span class="n">biases</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">Required</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">output</span> <span class="n">matrices</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span>               <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">TADbit</span><span class="o">-</span><span class="n">generated</span> <span class="n">BAM</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">reads</span> <span class="p">(</span><span class="n">other</span> <span class="n">wise</span> <span class="n">the</span>
                           <span class="n">tool</span> <span class="n">will</span> <span class="n">guess</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">database</span><span class="p">)</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">jobid</span> <span class="n">INT</span>      <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">max_njobs</span> <span class="n">INT</span>          <span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="n">Define</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">jobs</span> <span class="k">for</span> <span class="n">reading</span> <span class="n">BAM</span> <span class="n">file</span> <span class="p">(</span><span class="nb">set</span> <span class="n">to</span>
                           <span class="n">higher</span> <span class="n">numbers</span> <span class="k">for</span> <span class="n">large</span> <span class="n">files</span> <span class="ow">and</span> <span class="n">low</span> <span class="n">RAM</span> <span class="n">memory</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">normalize_only</span>         <span class="n">skip</span> <span class="n">calculation</span> <span class="n">of</span> <span class="n">Cis</span><span class="o">-</span><span class="n">percentage</span> <span class="ow">and</span> <span class="n">decay</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>

<span class="n">Bin</span> <span class="n">filtering</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">min_count</span> <span class="n">INT</span>          <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="n">minimum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">mapped</span> <span class="n">to</span> <span class="n">a</span> <span class="nb">bin</span> <span class="p">(</span><span class="n">recommended</span> <span class="n">value</span>
                           <span class="n">could</span> <span class="n">be</span> <span class="mi">2500</span><span class="p">)</span><span class="o">.</span> <span class="n">If</span> <span class="nb">set</span> <span class="n">this</span> <span class="n">option</span> <span class="n">overrides</span> <span class="n">the</span> <span class="n">perc_zero</span>
                           <span class="n">filtering</span><span class="o">...</span> <span class="n">This</span> <span class="n">option</span> <span class="ow">is</span> <span class="n">slightly</span> <span class="n">slower</span><span class="o">.</span>
  <span class="o">--</span><span class="n">cis_limit</span> <span class="n">CIS_LIMIT</span>    <span class="n">Maximum</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">bins</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">consider</span> <span class="n">an</span> <span class="n">interaction</span> <span class="n">cis</span> <span class="k">for</span>
                           <span class="n">the</span> <span class="n">filtering</span><span class="o">.</span> <span class="n">By</span> <span class="n">default</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">bins</span> <span class="n">corresponding</span> <span class="n">to</span>
                           <span class="mi">1</span><span class="n">Mb</span>
  <span class="o">--</span><span class="n">trans_limit</span> <span class="n">TRANS_LIMIT</span>
                           <span class="n">Maximum</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">bins</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">consider</span> <span class="n">an</span> <span class="n">interaction</span> <span class="n">trans</span>
                           <span class="k">for</span> <span class="n">the</span> <span class="n">filtering</span><span class="o">.</span> <span class="n">By</span> <span class="n">default</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">five</span> <span class="n">times</span> <span class="n">the</span> <span class="n">cis_limit</span> <span class="p">(</span><span class="k">if</span>
                           <span class="n">also</span> <span class="n">default</span><span class="p">,</span> <span class="n">it</span> <span class="n">would</span> <span class="n">correspond</span> <span class="n">to</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">bins</span> <span class="n">needed</span> <span class="n">to</span>
                           <span class="n">reach</span> <span class="mi">5</span><span class="n">Mb</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">ratio_limit</span> <span class="n">RATIO_LIMIT</span>
                           <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="n">Minimum</span> <span class="n">cis</span><span class="o">/</span><span class="n">trans</span> <span class="p">(</span><span class="k">as</span> <span class="n">defined</span> <span class="k">with</span> <span class="n">cis_limit</span> <span class="ow">and</span> <span class="n">trans_limit</span>
                           <span class="n">parameters</span><span class="p">)</span> <span class="n">to</span> <span class="nb">filter</span> <span class="n">out</span> <span class="n">bins</span><span class="o">.</span>
  <span class="o">--</span><span class="n">cistrans_filter</span>        <span class="nb">filter</span> <span class="n">using</span> <span class="n">cis</span><span class="o">-</span><span class="n">trans</span> <span class="n">ratio</span><span class="o">.</span>
  <span class="o">--</span><span class="n">filter_only</span>            <span class="n">skip</span> <span class="n">normalization</span>
  <span class="o">-</span><span class="n">B</span> <span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="p">[</span><span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="n">badcols</span> <span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="p">[</span><span class="n">CHR</span><span class="p">:</span><span class="n">POS1</span><span class="o">-</span><span class="n">POS2</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">extra</span> <span class="n">regions</span> <span class="n">to</span> <span class="n">be</span> <span class="n">added</span> <span class="n">to</span> <span class="n">bad</span><span class="o">-</span><span class="n">columns</span> <span class="p">(</span><span class="n">ingenomic</span> <span class="n">position</span><span class="p">)</span><span class="o">.</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span>
                           <span class="o">--</span><span class="n">badcols</span> <span class="mi">1</span><span class="p">:</span><span class="mi">150000000</span><span class="o">-</span><span class="mi">160000000</span> <span class="mi">2</span><span class="p">:</span><span class="mi">1200000</span><span class="o">-</span><span class="mi">1300000</span>

<span class="n">Read</span> <span class="n">filtering</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">os</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--apply 1 2 3 4 8 9 10&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span>
                           <span class="n">numberscorrespond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span>
                           <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span> <span class="n">short</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="n">too</span>
                           <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span> <span class="n">breaks</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span>
                           <span class="n">trans</span><span class="o">-</span><span class="n">chromosomic</span>
  <span class="o">--</span><span class="n">valid</span>                  <span class="nb">input</span> <span class="n">BAM</span> <span class="n">file</span> <span class="n">contains</span> <span class="n">only</span> <span class="n">valid</span> <span class="n">pairs</span> <span class="p">(</span><span class="n">already</span> <span class="n">filtered</span><span class="p">)</span><span class="o">.</span>

<span class="n">Normalization</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">normalization</span> <span class="n">STR</span>      <span class="p">[</span><span class="n">Vanilla</span><span class="p">]</span> <span class="n">normalization</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">apply</span><span class="o">.</span> <span class="n">Order</span> <span class="n">matters</span><span class="o">.</span> <span class="n">Choices</span><span class="p">:</span>
                           <span class="n">Vanilla</span><span class="p">,</span> <span class="n">ICE</span><span class="p">,</span> <span class="n">SQRT</span><span class="p">,</span> <span class="n">oneD</span><span class="p">,</span> <span class="n">custom</span>
  <span class="o">--</span><span class="n">biases_path</span> <span class="n">BIASES_PATH</span>
                           <span class="n">biases</span> <span class="n">file</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">decay</span><span class="o">.</span> <span class="n">REQUIRED</span> <span class="k">with</span> <span class="s2">&quot;custom&quot;</span> <span class="n">normalization</span><span class="o">.</span>
                           <span class="n">Format</span><span class="p">:</span> <span class="n">single</span> <span class="n">column</span> <span class="k">with</span> <span class="n">header</span>
  <span class="o">--</span><span class="n">mappability</span> <span class="n">PATH</span>       <span class="n">Path</span> <span class="n">to</span> <span class="n">mappability</span> <span class="n">bedGraph</span> <span class="n">file</span><span class="p">,</span> <span class="n">required</span> <span class="k">for</span> <span class="n">oneD</span> <span class="n">normalization</span><span class="o">.</span>
                           <span class="n">Mappability</span> <span class="n">file</span> <span class="n">can</span> <span class="n">be</span> <span class="n">generated</span> <span class="k">with</span> <span class="n">GEM</span> <span class="p">(</span><span class="n">example</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">genomic</span> <span class="n">FASTA</span> <span class="n">file</span> <span class="n">hg38</span><span class="o">.</span><span class="n">fa</span><span class="p">):</span>

                                <span class="n">gem</span><span class="o">-</span><span class="n">indexer</span> <span class="o">-</span><span class="n">i</span> <span class="n">hg38</span><span class="o">.</span><span class="n">fa</span> <span class="o">-</span><span class="n">o</span> <span class="n">hg38</span>
                                <span class="n">gem</span><span class="o">-</span><span class="n">mappability</span> <span class="o">-</span><span class="n">I</span> <span class="n">hg38</span><span class="o">.</span><span class="n">gem</span> <span class="o">-</span><span class="n">l</span> <span class="mi">50</span> <span class="o">-</span><span class="n">o</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span> <span class="o">-</span><span class="n">T</span> <span class="mi">8</span>
                                <span class="n">gem</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">wig</span> <span class="o">-</span><span class="n">I</span> <span class="n">hg38</span><span class="o">.</span><span class="n">gem</span> <span class="o">-</span><span class="n">i</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">mappability</span> <span class="o">-</span><span class="n">o</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span>
                                <span class="n">wigToBigWig</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">wig</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">sizes</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">bw</span>
                                <span class="n">bigWigToBedGraph</span> <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">bw</span>  <span class="n">hg38</span><span class="mf">.50</span><span class="n">mer</span><span class="o">.</span><span class="n">bedGraph</span>
  <span class="o">--</span><span class="n">fasta</span> <span class="n">PATH</span>             <span class="n">Path</span> <span class="n">to</span> <span class="n">FASTA</span> <span class="n">file</span> <span class="k">with</span> <span class="n">genome</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">GC</span> <span class="n">content</span> <span class="ow">and</span>
                           <span class="n">number</span> <span class="n">of</span> <span class="n">restriction</span> <span class="n">sites</span> <span class="n">per</span> <span class="nb">bin</span><span class="o">.</span> <span class="n">Required</span> <span class="k">for</span> <span class="n">oneD</span> <span class="n">normalization</span>
  <span class="o">--</span><span class="n">renz</span> <span class="n">STR</span>               <span class="n">restriction</span> <span class="n">enzyme</span> <span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Required</span> <span class="k">for</span> <span class="n">oneD</span> <span class="n">normalization</span>
  <span class="o">--</span><span class="n">factor</span> <span class="n">NUM</span>             <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">target</span> <span class="n">mean</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="n">cell</span> <span class="n">after</span> <span class="n">normalization</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span>
                           <span class="n">weight</span> <span class="n">experiments</span> <span class="n">before</span> <span class="n">merging</span><span class="p">)</span>
  <span class="o">--</span><span class="n">prop_data</span> <span class="n">FLOAT</span>        <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Only</span> <span class="k">for</span> <span class="n">oneD</span> <span class="n">normalization</span><span class="p">:</span> <span class="n">proportion</span> <span class="n">of</span> <span class="n">data</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span>
                           <span class="n">fitting</span> <span class="p">(</span><span class="k">for</span> <span class="n">very</span> <span class="n">large</span> <span class="n">datasets</span><span class="p">)</span><span class="o">.</span> <span class="n">Number</span> <span class="n">between</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mf">1.</span>
  <span class="o">--</span><span class="n">seed</span> <span class="n">INT</span>               <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Only</span> <span class="k">for</span> <span class="n">oneD</span> <span class="n">normalization</span><span class="p">:</span> <span class="n">seed</span> <span class="n">number</span> <span class="k">for</span> <span class="n">the</span> <span class="n">random</span> <span class="n">picking</span>
                           <span class="n">of</span> <span class="n">data</span> <span class="n">when</span> <span class="n">using</span> <span class="n">the</span> <span class="s2">&quot;prop_data&quot;</span> <span class="n">parameter</span>
</pre></div>
</div>
</section>
<section id="tadbit-bin">
<h2>TADbit bin<a class="headerlink" href="#tadbit-bin" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Bin</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="n">into</span> <span class="n">matrices</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="nb">bin</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="o">-</span><span class="n">r</span> <span class="n">INT</span> <span class="p">[</span><span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">q</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nchunks</span> <span class="n">NCHUNKS</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">matrix</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cooler</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rownames</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">plot</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force_plot</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">only_plot</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">triangular</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">xtick_rotation</span> <span class="n">XTICK_ROTATION</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cmap</span> <span class="n">CMAP</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">bad_color</span> <span class="n">BAD_COLOR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="n">FORMAT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">zrange</span> <span class="n">ZRANGE</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">transform</span> <span class="p">{</span><span class="n">log2</span><span class="p">,</span><span class="n">log</span><span class="p">,</span><span class="n">none</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">figsize</span> <span class="n">FIGSIZE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tad_def</span> <span class="n">TAD_DEF</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">-</span><span class="n">c2</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">norm</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">only_txt</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">Required</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">output</span> <span class="n">matrices</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span>               <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">TADbit</span><span class="o">-</span><span class="n">generated</span> <span class="n">BAM</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">reads</span> <span class="p">(</span><span class="n">other</span> <span class="n">wise</span> <span class="n">the</span>
                           <span class="n">tool</span> <span class="n">will</span> <span class="n">guess</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">database</span><span class="p">)</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">jobid</span> <span class="n">INT</span>      <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">overwrite</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>
  <span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">--</span><span class="n">quiet</span>              <span class="n">remove</span> <span class="nb">all</span> <span class="n">messages</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">nchunks</span> <span class="n">NCHUNKS</span>        <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">chunks</span> <span class="n">into</span> <span class="n">which</span> <span class="n">to</span> <span class="n">cut</span> <span class="n">the</span> <span class="n">BAM</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[</span><span class="n">fasta</span> <span class="n">header</span><span class="p">]</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Order</span> <span class="n">of</span> <span class="n">chromosomes</span> <span class="ow">in</span> <span class="n">the</span>
                           <span class="n">output</span> <span class="n">matrices</span><span class="o">.</span>

<span class="n">Read</span> <span class="n">filtering</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">os</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--apply 1 2 3 4 8 9 10&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span>
                           <span class="n">numberscorrespond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">nothing</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span>
                           <span class="mi">3</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span>
                           <span class="n">short</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="n">too</span> <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span>
                           <span class="n">breaks</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="n">trans</span><span class="o">-</span><span class="n">chromosomic</span>

<span class="n">Normalization</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span>            <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="k">with</span> <span class="n">pre</span><span class="o">-</span><span class="n">calculated</span> <span class="n">biases</span> <span class="n">by</span> <span class="n">columns</span>
  <span class="o">--</span><span class="n">norm</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>     <span class="p">[[</span><span class="s1">&#39;raw&#39;</span><span class="p">]]</span> <span class="n">normalization</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">apply</span><span class="o">.</span> <span class="n">Choices</span> <span class="n">are</span><span class="p">:</span> <span class="p">[</span><span class="n">norm</span><span class="p">,</span> <span class="n">decay</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span>
                           <span class="n">raw</span><span class="o">&amp;</span><span class="n">decay</span><span class="p">]</span>

<span class="n">Output</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">matrix</span>                 <span class="n">Write</span> <span class="n">text</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">multiple</span> <span class="n">columns</span> <span class="p">(</span><span class="n">square</span><span class="p">)</span><span class="o">.</span> <span class="n">By</span> <span class="n">defaults</span> <span class="n">matrices</span>
                           <span class="n">are</span> <span class="n">written</span> <span class="ow">in</span> <span class="n">BED</span><span class="o">-</span><span class="n">like</span> <span class="nb">format</span> <span class="p">(</span><span class="n">also</span> <span class="n">only</span> <span class="n">way</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">raw</span> <span class="n">matrix</span>
                           <span class="k">with</span> <span class="nb">all</span> <span class="n">values</span> <span class="n">including</span> <span class="n">the</span> <span class="n">ones</span> <span class="ow">in</span> <span class="n">masked</span> <span class="n">columns</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">cooler</span>                 <span class="n">Write</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">v</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">cooler</span> <span class="nb">format</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">text</span><span class="o">.</span>
  <span class="o">--</span><span class="n">rownames</span>               <span class="n">To</span> <span class="n">store</span> <span class="n">row</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">output</span> <span class="n">text</span> <span class="n">matrix</span><span class="o">.</span> <span class="n">WARNING</span><span class="p">:</span> <span class="n">when</span> <span class="n">non</span><span class="o">-</span>
                           <span class="n">matrix</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">two</span> <span class="n">extra</span> <span class="n">columns</span>
  <span class="o">--</span><span class="n">only_plot</span>              <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">Skip</span> <span class="n">writing</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">text</span> <span class="nb">format</span><span class="o">.</span>
  <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="o">--</span><span class="n">interactive</span>        <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">Open</span> <span class="n">matplotlib</span> <span class="n">interactive</span> <span class="n">plot</span> <span class="p">(</span><span class="n">nothing</span> <span class="n">will</span> <span class="n">be</span> <span class="n">saved</span><span class="p">)</span><span class="o">.</span>
  <span class="o">-</span><span class="n">c</span> <span class="p">,</span> <span class="o">--</span><span class="n">coord</span>             <span class="n">Coordinate</span> <span class="n">of</span> <span class="n">the</span> <span class="n">region</span> <span class="n">to</span> <span class="n">retrieve</span><span class="o">.</span> <span class="n">By</span> <span class="n">default</span> <span class="nb">all</span> <span class="n">genome</span><span class="p">,</span>
                           <span class="n">arguments</span> <span class="n">can</span> <span class="n">be</span> <span class="n">either</span> <span class="n">one</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">,</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">coordinate</span> <span class="ow">in</span>
                           <span class="n">the</span> <span class="n">form</span><span class="p">:</span> <span class="s2">&quot;-c chr3:110000000-120000000&quot;</span>
  <span class="o">-</span><span class="n">c2</span> <span class="p">,</span> <span class="o">--</span><span class="n">coord2</span>           <span class="n">Coordinate</span> <span class="n">of</span> <span class="n">a</span> <span class="n">second</span> <span class="n">region</span> <span class="n">to</span> <span class="n">retrieve</span> <span class="n">the</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">the</span>
                           <span class="n">intersection</span> <span class="k">with</span> <span class="n">the</span> <span class="n">first</span> <span class="n">region</span><span class="o">.</span>
  <span class="o">--</span><span class="n">only_txt</span>               <span class="n">Save</span> <span class="n">only</span> <span class="n">text</span> <span class="n">file</span> <span class="k">for</span> <span class="n">matrices</span><span class="p">,</span> <span class="ow">not</span> <span class="n">images</span>

<span class="n">Plotting</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">plot</span>                   <span class="n">Plot</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">desired</span> <span class="nb">format</span><span class="o">.</span>
  <span class="o">--</span><span class="n">force_plot</span>             <span class="n">Force</span> <span class="n">plotting</span> <span class="n">even</span> <span class="k">with</span> <span class="n">demoniacally</span> <span class="n">big</span> <span class="n">matrices</span> <span class="p">(</span><span class="n">more</span> <span class="n">than</span>
                           <span class="mi">5000</span><span class="n">x5000</span><span class="p">,</span> <span class="ow">or</span> <span class="mi">1500</span><span class="n">x1500with</span> <span class="n">interactive</span> <span class="n">option</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">triangular</span>             <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">represents</span> <span class="n">only</span> <span class="n">half</span> <span class="n">matrix</span><span class="o">.</span> <span class="n">Note</span> <span class="n">that</span> <span class="n">this</span> <span class="n">also</span> <span class="n">results</span> <span class="ow">in</span>
                           <span class="n">truly</span> <span class="n">vectorial</span> <span class="n">images</span> <span class="n">of</span> <span class="n">matrix</span><span class="o">.</span>
  <span class="o">--</span><span class="n">xtick_rotation</span> <span class="n">XTICK_ROTATION</span>
                           <span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">]</span> <span class="n">x</span><span class="o">-</span><span class="n">tick</span> <span class="n">rotation</span>
  <span class="o">--</span><span class="n">cmap</span> <span class="n">CMAP</span>              <span class="p">[</span><span class="n">viridis</span><span class="p">]</span> <span class="n">Matplotlib</span> <span class="n">color</span> <span class="nb">map</span> <span class="n">to</span> <span class="n">use</span><span class="o">.</span>
  <span class="o">--</span><span class="n">bad_color</span> <span class="n">BAD_COLOR</span>    <span class="p">[</span><span class="n">white</span><span class="p">]</span> <span class="n">Matplotlib</span> <span class="n">color</span> <span class="n">to</span> <span class="n">use</span> <span class="n">on</span> <span class="n">bins</span> <span class="n">filtered</span> <span class="n">out</span> <span class="p">(</span><span class="n">only</span> <span class="n">used</span> <span class="k">with</span>
                           <span class="n">normalized</span> <span class="n">matrices</span><span class="p">,</span> <span class="ow">not</span> <span class="n">raw</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="nb">format</span> <span class="n">FORMAT</span>          <span class="p">[</span><span class="n">png</span><span class="p">]</span> <span class="n">plot</span> <span class="n">file</span> <span class="nb">format</span><span class="o">.</span>
  <span class="o">--</span><span class="n">zrange</span> <span class="n">ZRANGE</span>          <span class="n">Range</span><span class="p">,</span> <span class="ow">in</span> <span class="n">log2</span> <span class="n">scale</span> <span class="n">of</span> <span class="n">the</span> <span class="n">color</span> <span class="n">scale</span><span class="o">.</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="o">--</span><span class="n">zrange</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span>
  <span class="o">--</span><span class="n">transform</span> <span class="p">{</span><span class="n">log2</span><span class="p">,</span><span class="n">log</span><span class="p">,</span><span class="n">none</span><span class="p">}</span>
                           <span class="p">[</span><span class="n">log2</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="nb">any</span> <span class="n">of</span> <span class="p">[</span><span class="n">log2</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">none</span><span class="p">]</span>
  <span class="o">--</span><span class="n">figsize</span> <span class="n">FIGSIZE</span>        <span class="n">Range</span><span class="p">,</span> <span class="ow">in</span> <span class="n">log2</span> <span class="n">scale</span> <span class="n">of</span> <span class="n">the</span> <span class="n">color</span> <span class="n">scale</span><span class="o">.</span> <span class="n">default</span> <span class="k">for</span> <span class="n">triangular</span>
                           <span class="n">matrices</span><span class="p">:</span> <span class="o">--</span><span class="n">figsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span> <span class="ow">and</span> <span class="k">for</span> <span class="n">square</span> <span class="n">matrices</span><span class="p">:</span> <span class="o">--</span><span class="n">figsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="mi">14</span>
  <span class="o">--</span><span class="n">tad_def</span> <span class="n">TAD_DEF</span>        <span class="n">jobid</span> <span class="k">with</span> <span class="n">the</span> <span class="n">TAD</span> <span class="n">segmentation</span><span class="p">,</span> <span class="n">alternatively</span> <span class="n">a</span> <span class="n">tsv</span> <span class="n">file</span> <span class="k">with</span> <span class="n">tad</span>
                           <span class="n">definition</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="c1"># start end score density</span>
</pre></div>
</div>
</section>
<section id="tadbit-segment">
<h2>TADbit segment<a class="headerlink" href="#tadbit-segment" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Finds</span> <span class="n">TAD</span> <span class="ow">or</span> <span class="n">compartment</span> <span class="n">segmentation</span> <span class="ow">in</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span><span class="o">.</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">segment</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nosql</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">all_bins</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">mreads</span> <span class="n">PATH</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span><span class="p">]</span> <span class="o">-</span><span class="n">r</span> <span class="n">INT</span> <span class="p">[</span><span class="o">--</span><span class="n">norm_matrix</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">raw_matrix</span> <span class="n">PATH</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rich_in_A</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">fasta</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">savecorr</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">fix_corr_scale</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="n">FORMAT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">n_evs</span> <span class="n">INT</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">--</span><span class="n">ev_index</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">only_compartments</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">only_tads</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">max_tad_size</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">nosql</span>                  <span class="n">do</span> <span class="ow">not</span> <span class="n">load</span><span class="o">/</span><span class="n">store</span> <span class="n">data</span> <span class="n">from</span><span class="o">/</span><span class="ow">in</span> <span class="n">sqlite</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">all_bins</span>               <span class="n">skip</span> <span class="n">the</span> <span class="n">filtering</span> <span class="n">of</span> <span class="n">bins</span> <span class="k">for</span> <span class="n">detection</span> <span class="n">of</span> <span class="n">TADs</span>
  <span class="o">--</span><span class="n">mreads</span> <span class="n">PATH</span>            <span class="n">path</span> <span class="n">valid</span><span class="o">-</span><span class="n">pairs</span> <span class="n">file</span> <span class="p">(</span><span class="n">TADbit</span> <span class="n">BAM</span> <span class="nb">format</span><span class="p">)</span>
  <span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span>            <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="k">with</span> <span class="n">precalculated</span> <span class="n">biases</span> <span class="n">by</span> <span class="n">columns</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">output</span> <span class="n">matrices</span>
  <span class="o">--</span><span class="n">norm_matrix</span> <span class="n">PATH</span>       <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">matrix</span> <span class="n">file</span> <span class="k">with</span> <span class="n">normalized</span> <span class="n">read</span> <span class="n">counts</span>
  <span class="o">--</span><span class="n">raw_matrix</span> <span class="n">PATH</span>        <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">matrix</span> <span class="n">file</span> <span class="k">with</span> <span class="n">raw</span> <span class="n">read</span> <span class="n">counts</span>
  <span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">os</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--apply 1 2 3 4 8 9 10&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span>
                           <span class="n">numberscorrespond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span>
                           <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span> <span class="n">short</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="n">too</span>
                           <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span> <span class="n">breaks</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span>
                           <span class="n">trans</span><span class="o">-</span><span class="n">chromosomic</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">only_compartments</span>      <span class="n">search</span> <span class="n">A</span><span class="o">/</span><span class="n">B</span> <span class="n">compartments</span> <span class="n">using</span> <span class="n">first</span> <span class="n">eigen</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">the</span> <span class="n">correlation</span>
                           <span class="n">matrix</span>
  <span class="o">--</span><span class="n">only_tads</span>              <span class="n">search</span> <span class="n">TAD</span> <span class="n">boundaries</span> <span class="k">break</span><span class="o">-</span><span class="n">point</span> <span class="n">detection</span> <span class="n">algorithm</span>
  <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="o">--</span><span class="n">verbose</span>            <span class="nb">print</span> <span class="n">more</span> <span class="n">messages</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">jobid</span> <span class="n">INT</span>      <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">-</span><span class="n">c</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="n">chromosomes</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">chromosomes</span> <span class="n">on</span> <span class="n">which</span> <span class="n">to</span> <span class="n">search</span> <span class="k">for</span> <span class="n">TADs</span> <span class="ow">or</span> <span class="n">compartments</span><span class="o">.</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpu</span> <span class="n">CPUS</span>      <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">overwrite</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>

<span class="n">Compartment</span> <span class="n">calling</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">rich_in_A</span> <span class="n">PATH</span>         <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">BED</span> <span class="ow">or</span> <span class="n">bedGraph</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">protein</span> <span class="n">coding</span> <span class="n">gene</span> <span class="ow">or</span>
                           <span class="n">other</span> <span class="n">active</span> <span class="n">epigenetic</span> <span class="n">mark</span><span class="p">,</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">label</span> <span class="n">compartments</span>
                           <span class="n">instead</span> <span class="n">of</span> <span class="n">using</span> <span class="n">the</span> <span class="n">relative</span> <span class="n">interaction</span> <span class="n">count</span><span class="o">.</span>
  <span class="o">--</span><span class="n">fasta</span> <span class="n">PATH</span>             <span class="n">Path</span> <span class="n">to</span> <span class="n">fasta</span> <span class="n">file</span> <span class="k">with</span> <span class="n">genome</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">GC</span> <span class="n">content</span> <span class="ow">and</span>
                           <span class="n">use</span> <span class="n">it</span> <span class="n">to</span> <span class="n">label</span> <span class="n">compartments</span>
  <span class="o">--</span><span class="n">savecorr</span>               <span class="n">Save</span> <span class="n">correlation</span> <span class="n">matrix</span> <span class="n">used</span> <span class="n">to</span> <span class="n">predict</span> <span class="n">compartments</span><span class="o">.</span>
  <span class="o">--</span><span class="n">fix_corr_scale</span>         <span class="n">Correlation</span> <span class="n">matrix</span> <span class="n">plot</span> <span class="n">scaled</span> <span class="n">between</span> <span class="n">correlation</span> <span class="mi">1</span> <span class="ow">and</span> <span class="o">-</span><span class="mi">1</span> <span class="n">instead</span>
                           <span class="n">of</span> <span class="n">maximum</span> <span class="n">observed</span> <span class="n">values</span><span class="o">.</span>
  <span class="o">--</span><span class="nb">format</span> <span class="n">FORMAT</span>          <span class="p">[</span><span class="n">png</span><span class="p">]</span> <span class="n">file</span> <span class="nb">format</span> <span class="k">for</span> <span class="n">figures</span>
  <span class="o">--</span><span class="n">n_evs</span> <span class="n">INT</span>              <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">eigenvectors</span> <span class="n">to</span> <span class="n">store</span><span class="o">.</span> <span class="k">if</span> <span class="s2">&quot;-1&quot;</span> <span class="nb">all</span> <span class="n">eigenvectors</span> <span class="n">will</span>
                           <span class="n">be</span> <span class="n">calculated</span>
  <span class="o">--</span><span class="n">ev_index</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="nb">list</span> <span class="n">of</span> <span class="n">indexes</span> <span class="n">of</span> <span class="n">eigenvectors</span> <span class="n">capturing</span> <span class="n">compartments</span> <span class="n">signal</span> <span class="p">(</span><span class="n">one</span>
                           <span class="n">index</span> <span class="n">per</span> <span class="n">chromosome</span><span class="p">,</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">order</span> <span class="k">as</span> <span class="n">chromosomes</span> <span class="ow">in</span> <span class="n">fasta</span>
                           <span class="n">file</span><span class="p">)</span><span class="o">.</span> <span class="n">Example</span> <span class="n">picking</span> <span class="n">the</span> <span class="n">first</span> <span class="n">eigenvector</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">chromosomes</span> <span class="n">but</span>
                           <span class="k">for</span> <span class="n">chromosome</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;--ev_index 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
                           <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>

<span class="n">TAD</span> <span class="n">calling</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">max_tad_size</span> <span class="n">INT</span>       <span class="n">an</span> <span class="n">integer</span> <span class="n">defining</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">size</span> <span class="n">of</span> <span class="n">TAD</span><span class="o">.</span> <span class="n">Default</span> <span class="n">defines</span> <span class="n">it</span> <span class="k">as</span>
                           <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">rows</span><span class="o">/</span><span class="n">columns</span>
</pre></div>
</div>
</section>
<section id="tadbit-model">
<h2>TADbit model<a class="headerlink" href="#tadbit-model" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Generates</span> <span class="mi">3</span><span class="n">D</span> <span class="n">models</span> <span class="n">given</span> <span class="n">an</span> <span class="nb">input</span> <span class="n">interaction</span> <span class="n">matrix</span> <span class="ow">and</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">of</span> <span class="nb">input</span> <span class="n">parameters</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">model</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="p">[</span><span class="o">--</span><span class="n">input_matrix</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rand</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nmodels</span> <span class="n">INT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">nkeep</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">optimization_id</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">restart_id</span> <span class="n">INT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">fig_format</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">corr</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">species</span> <span class="n">STRING</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">assembly</span> <span class="n">STRING</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cell</span> <span class="n">STRING</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">exp_type</span> <span class="n">STRING</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">project</span> <span class="n">STRING</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">crm</span> <span class="n">NAME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">beg</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">end</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">matrix_beg</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">perc_zero</span> <span class="n">FLOAT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">smooth_factor</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">optimize</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">model_ptadbit</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">maxdist</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">upfreq</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">lowfreq</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">scale</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">dcutoff</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">container</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">analyze</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">job_list</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">nmodels_per_job</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cpus_per_job</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">concurrent_jobs</span> <span class="n">INT</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">timeout_job</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">script_cmd</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">script_args</span> <span class="n">STR</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">script_template</span> <span class="n">STR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">analyze_list</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">not_write_cmm</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">not_write_xyz</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">not_write_json</span><span class="p">]</span>

<span class="n">Generates</span> <span class="mi">3</span><span class="n">D</span> <span class="n">models</span> <span class="n">given</span> <span class="n">an</span> <span class="nb">input</span> <span class="n">interaction</span> <span class="n">matrix</span> <span class="ow">and</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">of</span> <span class="nb">input</span> <span class="n">parameters</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">TADbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">--</span><span class="n">input_matrix</span> <span class="n">PATH</span>      <span class="n">In</span> <span class="n">case</span> <span class="nb">input</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">TADbit</span> <span class="n">tools</span>
  <span class="o">--</span><span class="n">rand</span> <span class="n">INT</span>               <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">random</span> <span class="n">initial</span> <span class="n">number</span><span class="o">.</span> <span class="n">NOTE</span><span class="p">:</span> <span class="n">when</span> <span class="n">running</span> <span class="n">single</span> <span class="n">model</span> <span class="n">at</span> <span class="n">the</span>
                           <span class="n">time</span><span class="p">,</span> <span class="n">should</span> <span class="n">be</span> <span class="n">different</span> <span class="k">for</span> <span class="n">each</span> <span class="n">run</span>
  <span class="o">--</span><span class="n">nmodels</span> <span class="n">INT</span>            <span class="p">[</span><span class="mi">5000</span><span class="p">]</span> <span class="n">number</span> <span class="n">of</span> <span class="n">models</span> <span class="n">to</span> <span class="n">generate</span> <span class="k">for</span> <span class="n">modeling</span>
  <span class="o">--</span><span class="n">nkeep</span> <span class="n">INT</span>              <span class="p">[</span><span class="mi">1000</span><span class="p">]</span> <span class="n">number</span> <span class="n">of</span> <span class="n">models</span> <span class="n">to</span> <span class="n">keep</span> <span class="k">for</span> <span class="n">modeling</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">jobid</span> <span class="n">INT</span>      <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">optimization_id</span> <span class="n">INT</span>    <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">a</span> <span class="n">pre</span><span class="o">-</span><span class="n">run</span> <span class="n">optimization</span> <span class="n">batch</span> <span class="n">job</span>
  <span class="o">--</span><span class="n">restart_id</span> <span class="n">INT</span>         <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">a</span> <span class="n">job</span> <span class="n">to</span> <span class="n">be</span> <span class="n">restarted</span><span class="p">,</span> <span class="k">for</span> <span class="n">example</span> <span class="n">after</span> <span class="n">building</span> <span class="n">the</span>
                           <span class="n">models</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">cluster</span>
  <span class="o">--</span><span class="n">fig_format</span> <span class="n">STR</span>         <span class="n">file</span> <span class="nb">format</span> <span class="ow">and</span> <span class="n">extension</span> <span class="k">for</span> <span class="n">figures</span> <span class="ow">and</span> <span class="n">plots</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="nb">any</span>
                           <span class="n">supported</span> <span class="n">by</span> <span class="n">matplotlib</span><span class="p">,</span> <span class="n">png</span><span class="p">,</span> <span class="n">eps</span><span class="o">...</span><span class="p">)</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">corr</span> <span class="n">STR</span>               <span class="n">correlation</span> <span class="n">method</span> <span class="n">to</span> <span class="n">compare</span> <span class="n">contact</span> <span class="n">maps</span> <span class="ow">and</span> <span class="n">original</span> <span class="n">matrix</span>
                           <span class="p">(</span><span class="n">options</span> <span class="n">are</span> <span class="n">speraman</span><span class="p">,</span> <span class="n">pearson</span><span class="p">,</span> <span class="n">kendall</span><span class="p">,</span> <span class="n">logpearson</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">scc</span> <span class="p">)</span>

<span class="n">Descriptive</span><span class="p">,</span> <span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">--</span><span class="n">species</span> <span class="n">STRING</span>         <span class="n">species</span> <span class="n">name</span><span class="p">,</span> <span class="k">with</span> <span class="n">no</span> <span class="n">spaces</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="n">homo_sapiens</span>
  <span class="o">--</span><span class="n">assembly</span> <span class="n">STRING</span>        <span class="n">NCBI</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="n">assembly</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="n">NCBI36</span> <span class="k">for</span> <span class="n">human</span><span class="p">)</span>
  <span class="o">--</span><span class="n">cell</span> <span class="n">STRING</span>            <span class="n">cell</span> <span class="nb">type</span> <span class="n">name</span>
  <span class="o">--</span><span class="n">exp_type</span> <span class="n">STRING</span>        <span class="n">experiment</span> <span class="nb">type</span> <span class="n">name</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span><span class="p">)</span>
  <span class="o">--</span><span class="n">project</span> <span class="n">STRING</span>         <span class="n">project</span> <span class="n">name</span>

<span class="n">Modeling</span> <span class="n">preparation</span><span class="p">:</span>
  <span class="o">--</span><span class="n">crm</span> <span class="n">NAME</span>               <span class="n">chromosome</span> <span class="n">name</span>
  <span class="o">--</span><span class="n">beg</span> <span class="n">INT</span>                <span class="n">genomic</span> <span class="n">coordinate</span> <span class="kn">from</span> <span class="nn">which</span> <span class="n">to</span> <span class="n">start</span> <span class="n">modeling</span>
  <span class="o">--</span><span class="n">end</span> <span class="n">INT</span>                <span class="n">genomic</span> <span class="n">coordinate</span> <span class="n">where</span> <span class="n">to</span> <span class="n">end</span> <span class="n">modeling</span>
  <span class="o">--</span><span class="n">matrix_beg</span> <span class="n">INT</span>         <span class="n">genomic</span> <span class="n">coordinate</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">row</span><span class="o">/</span><span class="n">column</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">matrix</span><span class="o">.</span> <span class="n">This</span>
                           <span class="n">has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">specified</span> <span class="k">if</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">the</span> <span class="n">TADbit</span> <span class="n">tools</span>
                           <span class="n">generated</span> <span class="n">abc</span> <span class="nb">format</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">reso</span> <span class="n">INT</span>       <span class="n">resolution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">experiment</span>
  <span class="o">--</span><span class="n">perc_zero</span> <span class="n">FLOAT</span>

<span class="n">Parameter</span> <span class="n">optimization</span><span class="p">:</span>
  <span class="o">--</span><span class="n">optimize</span>               <span class="n">optimization</span> <span class="n">run</span><span class="p">,</span> <span class="n">store</span> <span class="n">less</span> <span class="n">info</span> <span class="n">about</span> <span class="n">models</span>
  <span class="o">--</span><span class="n">model</span>                  <span class="n">modelling</span> <span class="n">run</span>
  <span class="o">--</span><span class="n">model_ptadbit</span>          <span class="n">modelling</span> <span class="n">run</span> <span class="n">using</span> <span class="n">pTADbit</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">use</span> <span class="nb">input</span> <span class="n">parameters</span><span class="p">,</span> <span class="ow">and</span> <span class="n">skip</span> <span class="nb">any</span> <span class="n">precalculated</span> <span class="n">optimization</span>
  <span class="o">--</span><span class="n">maxdist</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>
                           <span class="nb">range</span> <span class="n">of</span> <span class="n">numbers</span> <span class="k">for</span> <span class="n">maxdist</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="mi">400</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="mi">100</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">just</span> <span class="n">a</span> <span class="n">number</span>
                           <span class="o">--</span> <span class="ow">or</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">numbers</span>
  <span class="o">--</span><span class="n">upfreq</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>
                           <span class="nb">range</span> <span class="n">of</span> <span class="n">numbers</span> <span class="k">for</span> <span class="n">upfreq</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="mi">0</span><span class="p">:</span><span class="mf">1.2</span><span class="p">:</span><span class="mf">0.3</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">just</span> <span class="n">a</span> <span class="n">number</span> <span class="o">--</span>
                           <span class="ow">or</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">numbers</span>
  <span class="o">--</span><span class="n">lowfreq</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>
                           <span class="nb">range</span> <span class="n">of</span> <span class="n">numbers</span> <span class="k">for</span> <span class="n">lowfreq</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mf">0.3</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">just</span> <span class="n">a</span> <span class="n">number</span> <span class="o">--</span>
                           <span class="ow">or</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">numbers</span>
  <span class="o">--</span><span class="n">scale</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>  <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">numbers</span> <span class="n">to</span> <span class="n">be</span> <span class="n">test</span> <span class="k">as</span> <span class="n">optimal</span> <span class="n">scale</span> <span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span>
                           <span class="mf">0.005</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="mf">0.001</span> <span class="o">--</span> <span class="n">Can</span> <span class="n">also</span> <span class="k">pass</span> <span class="n">only</span> <span class="n">one</span> <span class="n">number</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span>
                           <span class="n">numbers</span>
  <span class="o">--</span><span class="n">dcutoff</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">numbers</span> <span class="n">to</span> <span class="n">be</span> <span class="n">test</span> <span class="k">as</span> <span class="n">optimal</span> <span class="n">distance</span> <span class="n">cutoff</span> <span class="n">parameter</span>
                           <span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="ow">in</span> <span class="n">number</span> <span class="n">of</span> <span class="n">beads</span><span class="p">,</span> <span class="kn">from</span> <span class="nn">which</span> <span class="n">to</span> <span class="n">consider</span> <span class="mi">2</span> <span class="n">beads</span> <span class="k">as</span>
                           <span class="n">being</span> <span class="n">close</span><span class="p">),</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="mi">1</span><span class="p">:</span><span class="mf">1.5</span><span class="p">:</span><span class="mf">0.5</span> <span class="o">--</span> <span class="n">Can</span> <span class="n">also</span> <span class="k">pass</span> <span class="n">only</span> <span class="n">one</span> <span class="n">number</span> <span class="o">--</span> <span class="ow">or</span>
                           <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">numbers</span>
  <span class="o">--</span><span class="n">container</span> <span class="n">LIST</span> <span class="p">[</span><span class="n">LIST</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">restrains</span> <span class="n">particle</span> <span class="n">to</span> <span class="n">be</span> <span class="n">within</span> <span class="n">a</span> <span class="n">given</span> <span class="nb">object</span><span class="o">.</span> <span class="n">Can</span> <span class="n">only</span> <span class="n">be</span> <span class="n">a</span>
                           <span class="s1">&#39;cylinder&#39;</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fact</span> <span class="n">a</span> <span class="n">cylinder</span> <span class="n">of</span> <span class="n">a</span> <span class="n">given</span> <span class="n">height</span> <span class="n">to</span> <span class="n">which</span>
                           <span class="n">are</span> <span class="n">added</span> <span class="n">hemispherical</span> <span class="n">ends</span><span class="o">.</span> <span class="n">This</span> <span class="n">cylinder</span> <span class="ow">is</span> <span class="n">defined</span> <span class="n">by</span> <span class="n">a</span> <span class="n">radius</span><span class="p">,</span>
                           <span class="n">its</span> <span class="n">height</span> <span class="p">(</span><span class="k">with</span> <span class="n">a</span> <span class="n">height</span> <span class="n">of</span> <span class="mi">0</span> <span class="n">the</span> <span class="n">cylinder</span> <span class="n">becomes</span> <span class="n">a</span> <span class="n">sphere</span><span class="p">)</span> <span class="ow">and</span>
                           <span class="n">the</span> <span class="n">force</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">the</span> <span class="n">restraint</span><span class="o">.</span> <span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="k">for</span> <span class="n">modeling</span> <span class="n">E</span><span class="o">.</span> <span class="n">coli</span> <span class="n">genome</span>
                           <span class="p">(</span><span class="mi">2</span> <span class="n">micrometers</span> <span class="n">length</span> <span class="ow">and</span> <span class="mf">0.5</span> <span class="n">micrometer</span> <span class="n">of</span> <span class="n">width</span><span class="p">),</span> <span class="n">these</span> <span class="n">values</span>
                           <span class="n">could</span> <span class="n">be</span> <span class="n">used</span><span class="p">:</span> <span class="s1">&#39;cylinder&#39;</span> <span class="mi">250</span> <span class="mi">1500</span> <span class="mi">50</span><span class="p">,</span> <span class="ow">and</span> <span class="k">for</span> <span class="n">a</span> <span class="n">typical</span> <span class="n">mammalian</span>
                           <span class="n">nuclei</span> <span class="p">(</span><span class="mi">6</span> <span class="n">micrometers</span> <span class="n">diameter</span><span class="p">):</span> <span class="s1">&#39;cylinder&#39;</span> <span class="mi">3000</span> <span class="mi">0</span> <span class="mi">50</span>
  <span class="o">--</span><span class="n">analyze</span>                <span class="n">analyze</span> <span class="n">models</span><span class="o">.</span>

<span class="n">Analysis</span><span class="p">:</span>
  <span class="o">--</span><span class="n">analyze_list</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span><span class="p">]</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">numbers</span> <span class="n">representing</span> <span class="n">the</span>
                           <span class="n">analysis</span> <span class="n">to</span> <span class="n">be</span> <span class="n">done</span><span class="o">.</span> <span class="n">Choose</span> <span class="n">between</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="n">do</span> <span class="n">nothing</span> <span class="mi">1</span><span class="p">)</span> <span class="n">optimization</span>
                           <span class="n">plot</span> <span class="mi">2</span><span class="p">)</span> <span class="n">correlation</span> <span class="n">real</span><span class="o">/</span><span class="n">models</span> <span class="mi">3</span><span class="p">)</span> <span class="n">z</span><span class="o">-</span><span class="n">score</span> <span class="n">plot</span> <span class="mi">4</span><span class="p">)</span> <span class="n">constraints</span> <span class="mi">5</span><span class="p">)</span>
                           <span class="n">objective</span> <span class="n">function</span> <span class="mi">6</span><span class="p">)</span> <span class="n">centroid</span> <span class="mi">7</span><span class="p">)</span> <span class="n">consistency</span> <span class="mi">8</span><span class="p">)</span> <span class="n">density</span> <span class="mi">9</span><span class="p">)</span> <span class="n">contact</span>
                           <span class="nb">map</span> <span class="mi">10</span><span class="p">)</span> <span class="n">walking</span> <span class="n">angle</span> <span class="mi">11</span><span class="p">)</span> <span class="n">persistence</span> <span class="n">length</span> <span class="mi">12</span><span class="p">)</span> <span class="n">accessibility</span> <span class="mi">13</span><span class="p">)</span>
                           <span class="n">interaction</span>
  <span class="o">--</span><span class="n">not_write_cmm</span>          <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">generate</span> <span class="n">cmm</span> <span class="n">files</span> <span class="k">for</span> <span class="n">each</span> <span class="n">model</span> <span class="p">(</span><span class="n">Chimera</span> <span class="nb">input</span><span class="p">)</span>
  <span class="o">--</span><span class="n">not_write_xyz</span>          <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">generate</span> <span class="n">xyz</span> <span class="n">files</span> <span class="k">for</span> <span class="n">each</span> <span class="n">model</span> <span class="p">(</span><span class="mi">3</span><span class="n">D</span> <span class="n">coordinates</span><span class="p">)</span>
  <span class="o">--</span><span class="n">not_write_json</span>         <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">generate</span> <span class="n">json</span> <span class="n">file</span><span class="o">.</span>

<span class="n">Running</span> <span class="n">jobs</span><span class="p">:</span>
  <span class="o">--</span><span class="n">smooth_factor</span> <span class="n">INT</span>      <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">matrix</span> <span class="n">smoothing</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">mean</span> <span class="n">kernel</span> <span class="k">for</span> <span class="n">pTADbit</span><span class="o">.</span> <span class="n">Useful</span>
                           <span class="ow">in</span> <span class="n">case</span> <span class="n">of</span> <span class="n">using</span> <span class="n">matrices</span> <span class="k">with</span> <span class="n">low</span> <span class="n">sequencing</span> <span class="n">depth</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpu</span> <span class="n">CPUS</span>      <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">job_list</span>               <span class="n">generate</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">commands</span> <span class="n">stored</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">file</span> <span class="n">named</span> <span class="n">joblist_HASH</span><span class="o">.</span><span class="n">q</span>
                           <span class="p">(</span><span class="n">where</span> <span class="n">HASH</span> <span class="ow">is</span> <span class="n">replaced</span> <span class="n">by</span> <span class="n">a</span> <span class="n">string</span> <span class="n">specific</span> <span class="n">to</span> <span class="n">the</span> <span class="n">parameters</span>
                           <span class="n">used</span><span class="p">)</span><span class="o">.</span> <span class="n">note</span> <span class="n">that</span> <span class="n">dcutoff</span> <span class="n">will</span> <span class="n">never</span> <span class="n">be</span> <span class="n">split</span> <span class="k">as</span> <span class="n">it</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">require</span>
                           <span class="n">to</span> <span class="n">re</span><span class="o">-</span><span class="n">run</span> <span class="n">models</span><span class="o">.</span>
  <span class="o">--</span><span class="n">nmodels_per_job</span> <span class="n">INT</span>    <span class="n">Number</span> <span class="n">of</span> <span class="n">models</span> <span class="n">per</span> <span class="n">distributed</span> <span class="n">job</span><span class="o">.</span>
  <span class="o">--</span><span class="n">cpus_per_job</span> <span class="n">INT</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">cpu</span> <span class="n">nodes</span> <span class="n">per</span> <span class="n">distributed</span> <span class="n">job</span><span class="o">.</span>
  <span class="o">--</span><span class="n">concurrent_jobs</span> <span class="n">INT</span>    <span class="n">Number</span> <span class="n">of</span> <span class="n">concurrent</span> <span class="n">jobs</span> <span class="ow">in</span> <span class="n">distributed</span> <span class="n">mode</span><span class="o">.</span>
  <span class="o">--</span><span class="n">timeout_job</span> <span class="n">INT</span>        <span class="n">Time</span> <span class="n">to</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">a</span> <span class="n">concurrent</span> <span class="n">jobs</span> <span class="n">to</span> <span class="n">finish</span> <span class="n">before</span> <span class="n">canceling</span> <span class="n">it</span> <span class="ow">in</span>
                           <span class="n">distributed</span> <span class="n">mode</span><span class="o">.</span>
  <span class="o">--</span><span class="n">script_cmd</span> <span class="n">STR</span>         <span class="n">Command</span> <span class="n">to</span> <span class="n">call</span> <span class="n">the</span> <span class="n">jobs</span> <span class="ow">in</span> <span class="n">distributed</span> <span class="n">mode</span><span class="o">.</span>
  <span class="o">--</span><span class="n">script_args</span> <span class="n">STR</span>        <span class="n">Argumnets</span> <span class="n">to</span> <span class="n">script_cmd</span> <span class="n">to</span> <span class="n">call</span> <span class="n">the</span> <span class="n">jobs</span> <span class="ow">in</span> <span class="n">distributed</span> <span class="n">mode</span><span class="o">.</span>
  <span class="o">--</span><span class="n">script_template</span> <span class="n">STR</span>    <span class="n">Template</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">file</span> <span class="n">that</span> <span class="n">script_cmd</span> <span class="n">will</span> <span class="n">call</span> <span class="k">for</span> <span class="n">each</span> <span class="n">job</span>
                           <span class="ow">in</span> <span class="n">distributed</span> <span class="n">mode</span><span class="o">.</span> <span class="n">Each</span> <span class="vm">__file__</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">template</span> <span class="n">will</span> <span class="n">be</span>
                           <span class="n">replacedby</span> <span class="n">the</span> <span class="n">job</span> <span class="n">file</span> <span class="vm">__name__</span> <span class="k">with</span> <span class="n">the</span> <span class="n">name</span> <span class="ow">and</span> <span class="fm">__dir__</span> <span class="k">with</span> <span class="n">the</span>
                           <span class="n">folder</span><span class="o">.</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
</pre></div>
</div>
</section>
<section id="tadbit-merge">
<h2>TADbit merge<a class="headerlink" href="#tadbit-merge" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Load</span> <span class="n">two</span> <span class="n">working</span> <span class="n">directories</span> <span class="k">with</span> <span class="n">different</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="n">samples</span> <span class="ow">and</span> <span class="n">merges</span> <span class="n">them</span> <span class="n">into</span> <span class="n">a</span> <span class="n">new</span>
<span class="n">working</span> <span class="n">directory</span> <span class="n">generating</span> <span class="n">some</span> <span class="n">statistics</span><span class="o">.</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">merge</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">w1</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">w2</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">bam1</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">bam2</span> <span class="n">PATH</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">skip_comparison</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">skip_merge</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">save</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">jobid1</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">jobid2</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">norm</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">biases1</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">biases2</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">new</span> <span class="n">output</span> <span class="n">folder</span>
  <span class="o">-</span><span class="n">w1</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir1</span> <span class="n">PATH</span>
                           <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">HiC</span> <span class="n">data</span> <span class="n">sample</span> <span class="n">to</span> <span class="n">merge</span>
  <span class="o">-</span><span class="n">w2</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir2</span> <span class="n">PATH</span>
                           <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">of</span> <span class="n">the</span> <span class="n">second</span> <span class="n">HiC</span> <span class="n">data</span> <span class="n">sample</span> <span class="n">to</span> <span class="n">merge</span>
  <span class="o">--</span><span class="n">bam1</span> <span class="n">PATH</span>              <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">first</span> <span class="n">TADbit</span><span class="o">-</span><span class="n">generated</span> <span class="n">BAM</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">reads</span> <span class="p">(</span><span class="n">other</span>
                           <span class="n">wise</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">will</span> <span class="n">guess</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">database</span><span class="p">)</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">bam2</span> <span class="n">PATH</span>              <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">second</span> <span class="n">TADbit</span><span class="o">-</span><span class="n">generated</span> <span class="n">BAM</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">reads</span> <span class="p">(</span><span class="n">other</span>
                           <span class="n">wise</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">will</span> <span class="n">guess</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">database</span><span class="p">)</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">do</span> <span class="n">the</span> <span class="n">comparison</span><span class="p">,</span> <span class="ow">and</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">matrices</span><span class="o">.</span>
  <span class="o">--</span><span class="n">skip_comparison</span>        <span class="n">skip</span> <span class="n">the</span> <span class="n">comparison</span> <span class="n">between</span> <span class="n">replicates</span> <span class="p">(</span><span class="n">faster</span><span class="p">)</span><span class="o">.</span> <span class="n">Comparisons</span> <span class="n">are</span>
                           <span class="n">performed</span> <span class="n">at</span> <span class="mi">3</span> <span class="n">levels</span> <span class="mi">1</span><span class="o">-</span> <span class="n">comparing</span> <span class="n">first</span> <span class="n">diagonals</span> <span class="n">of</span> <span class="n">each</span>
                           <span class="n">experiment</span> <span class="p">(</span><span class="ow">and</span> <span class="n">generating</span> <span class="n">SCC</span> <span class="n">score</span> <span class="ow">and</span> <span class="n">standard</span> <span class="n">deviation</span> <span class="n">see</span>
                           <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.1101</span><span class="o">/</span><span class="n">gr</span><span class="mf">.220640.117</span><span class="p">)</span> <span class="mi">2</span><span class="o">-</span> <span class="n">Comparing</span> <span class="n">the</span> <span class="n">first</span>
                           <span class="n">eigenvectors</span> <span class="n">of</span> <span class="nb">input</span> <span class="n">experiments</span> <span class="mi">3</span><span class="o">-</span> <span class="n">Generates</span> <span class="n">reproducibility</span> <span class="n">score</span>
                           <span class="n">using</span> <span class="n">function</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.1093</span><span class="o">/</span><span class="n">bioinformatics</span><span class="o">/</span><span class="n">btx152</span>
  <span class="o">--</span><span class="n">skip_merge</span>             <span class="n">skip</span> <span class="n">the</span> <span class="n">merge</span> <span class="n">of</span> <span class="n">replicates</span> <span class="p">(</span><span class="n">faster</span><span class="p">)</span><span class="o">.</span>
  <span class="o">--</span><span class="n">save</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>     <span class="p">[</span><span class="n">genome</span><span class="p">]</span> <span class="n">save</span> <span class="n">genomic</span> <span class="ow">or</span> <span class="n">chromosomic</span> <span class="n">matrix</span><span class="o">.</span>
  <span class="o">--</span><span class="n">jobid1</span> <span class="n">INT</span>             <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">jobid2</span> <span class="n">INT</span>             <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">overwrite</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>
  <span class="o">--</span><span class="n">norm</span>                   <span class="n">compare</span> <span class="n">normalized</span> <span class="n">matrices</span>
  <span class="o">--</span><span class="n">biases1</span> <span class="n">PATH</span>           <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="k">with</span> <span class="n">precalculated</span> <span class="n">biases</span> <span class="n">by</span> <span class="n">columns</span>
  <span class="o">--</span><span class="n">biases2</span> <span class="n">PATH</span>           <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="k">with</span> <span class="n">precalculated</span> <span class="n">biases</span> <span class="n">by</span> <span class="n">columns</span>
  <span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>   <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">os</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--apply 1 2 3 4 8 9 10&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span>
                           <span class="n">numberscorrespond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span>
                           <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span> <span class="n">short</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="n">too</span>
                           <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span> <span class="n">breaks</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span>
                           <span class="n">trans</span><span class="o">-</span><span class="n">chromosomic</span>
  <span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span>          <span class="n">path</span> <span class="n">samtools</span> <span class="n">binary</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
</pre></div>
</div>
</section>
<section id="tadbit-describe">
<h2>TADbit describe<a class="headerlink" href="#tadbit-describe" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Describe jobs and results in a given working directory

usage: tadbit describe [-h] [-w PATH] [--noX] [-t  [...]] [-T  [...]] [-j INT [INT ...]]
                       [-W STR [STR ...]] [-s STR [STR ...]] [--tmpdb PATH] [--tsv] [-o OUTPUT]

optional arguments:
  -h, --help               show this help message and exit

General options:
  -w PATH, --workdir PATH  path to working directory (generated with the tool tadbit map)
  --noX                    no display server (X screen)
  -t  [ ...], --tables  [ ...]
                           [[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
                           &#39;13&#39;]] what tables to show, write either the sequence of names or
                           indexes, according to this list: 1: paths, 2: jobs, 3:
                           mapped_outputs, 4: mapped_inputs, 5: parsed_outputs, 6:
                           intersection_outputs, 7: filter_outputs, 8: normalize_outputs, 9:
                           merge_stats, 10: merge_outputs, 11: segment_outputs, 12: models, 13:
                           modeled_regions
  -T  [ ...], --skip_tables  [ ...]
                           [[]] what tables NOT to show, write either the sequence of names or
                           indexes, according to this list: 1: paths, 2: jobs, 3:
                           mapped_outputs, 4: mapped_inputs, 5: parsed_outputs, 6:
                           intersection_outputs, 7: filter_outputs, 8: normalize_outputs, 9:
                           merge_stats, 10: merge_outputs, 11: segment_outputs, 12: models, 13:
                           modeled_regions
  -j INT [INT ...], --jobids INT [INT ...]
                           Display only items matching these jobids.
  -W STR [STR ...], --where STR [STR ...]
                           Select rows. List pairs of keywords (column header) and values to
                           filter results. For example to get only results where &quot;18&quot; appears
                           in the column &quot;Chromosome&quot;, the option should be set as: `-W
                           Chromosome,18`
  -s STR [STR ...], --select STR [STR ...]
                           Select columns. List the keyword (column headers) to be displayed.
                           E.g. to show only the colmns JobIds: `-s Jobids`
  --tmpdb PATH             if provided uses this directory to manipulate the database
  --tsv                    Print output in tab separated format
  -o OUTPUT, --output OUTPUT
                           Writes output in specified file.
</pre></div>
</div>
</section>
<section id="tadbit-clean">
<h2>TADbit clean<a class="headerlink" href="#tadbit-clean" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Delete</span> <span class="n">jobs</span> <span class="ow">and</span> <span class="n">results</span> <span class="n">of</span> <span class="n">a</span> <span class="n">given</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">jobids</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">given</span> <span class="n">directories</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">clean</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">delete</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">compress</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">noX</span><span class="p">]</span>
                    <span class="p">[</span><span class="o">--</span><span class="n">change_workdir</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">change_workdir</span> <span class="n">PATH</span>    <span class="n">In</span> <span class="n">case</span> <span class="n">folder</span> <span class="n">was</span> <span class="n">moved</span><span class="p">,</span> <span class="nb">input</span> <span class="n">the</span> <span class="n">new</span> <span class="n">path</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="n">jobids</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="n">jobids</span> <span class="n">of</span> <span class="n">the</span> <span class="n">files</span> <span class="ow">and</span> <span class="n">entries</span> <span class="n">to</span> <span class="n">be</span> <span class="n">removed</span>
  <span class="o">--</span><span class="n">delete</span>                 <span class="n">delete</span> <span class="n">files</span><span class="p">,</span> <span class="n">otherwise</span> <span class="n">only</span> <span class="n">DB</span> <span class="n">entries</span><span class="o">.</span>
  <span class="o">--</span><span class="n">compress</span>               <span class="n">compress</span> <span class="n">files</span> <span class="ow">and</span> <span class="n">update</span> <span class="n">paths</span> <span class="n">accordingly</span>
  <span class="o">--</span><span class="n">noX</span>                    <span class="n">no</span> <span class="n">display</span> <span class="n">server</span> <span class="p">(</span><span class="n">X</span> <span class="n">screen</span><span class="p">)</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
</pre></div>
</div>
</section>
<section id="tadbit-import">
<h2>TADbit import<a class="headerlink" href="#tadbit-import" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Import</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="n">to</span> <span class="n">TADbit</span> <span class="n">toy</span> <span class="n">BAM</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="kn">import</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="o">-</span><span class="n">r</span> <span class="n">INT</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">text</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">cooler</span><span class="p">}]</span> <span class="o">-</span><span class="n">i</span> <span class="n">STR</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">Required</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">output</span> <span class="n">matrices</span>
  <span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">text</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">cooler</span><span class="p">}</span>
                           <span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="nb">any</span> <span class="n">of</span> <span class="p">[</span><span class="n">text</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">cooler</span><span class="p">]</span>
  <span class="o">-</span><span class="n">i</span> <span class="n">STR</span><span class="p">,</span> <span class="o">--</span><span class="nb">input</span> <span class="n">STR</span>      <span class="n">path</span> <span class="n">to</span> <span class="nb">input</span> <span class="n">file</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">c</span> <span class="p">,</span> <span class="o">--</span><span class="n">coord</span>             <span class="n">Coordinate</span> <span class="n">of</span> <span class="n">the</span> <span class="n">region</span> <span class="n">to</span> <span class="n">import</span><span class="o">.</span> <span class="n">By</span> <span class="n">default</span> <span class="nb">all</span> <span class="n">genome</span><span class="p">,</span> <span class="n">arguments</span>
                           <span class="n">can</span> <span class="n">be</span> <span class="n">either</span> <span class="n">one</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">,</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">coordinate</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">form</span><span class="p">:</span>
                           <span class="s2">&quot;-c chr3:110000000-120000000&quot;</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">samtools</span> <span class="n">PATH</span>          <span class="n">path</span> <span class="n">samtools</span> <span class="n">binary</span>
</pre></div>
</div>
</section>
<section id="tadbit-export">
<h2>TADbit export<a class="headerlink" href="#tadbit-export" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Export</span> <span class="n">Hi</span><span class="o">-</span><span class="n">C</span> <span class="n">data</span> <span class="n">to</span> <span class="n">other</span> <span class="n">formats</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">tadbit</span> <span class="n">export</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span> <span class="o">-</span><span class="n">r</span> <span class="n">INT</span> <span class="p">[</span><span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">text</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">cooler</span><span class="p">,</span><span class="n">hic</span><span class="p">}]</span> <span class="o">-</span><span class="n">o</span> <span class="n">STR</span>
                     <span class="p">[</span><span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">force</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">q</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nchunks</span> <span class="n">NCHUNKS</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">juicerjar</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rownames</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span><span class="p">]</span>
                     <span class="p">[</span><span class="o">-</span><span class="n">c2</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">norm</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>               <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">Required</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">w</span> <span class="n">PATH</span><span class="p">,</span> <span class="o">--</span><span class="n">workdir</span> <span class="n">PATH</span>  <span class="n">path</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span> <span class="p">(</span><span class="n">generated</span> <span class="k">with</span> <span class="n">the</span> <span class="n">tool</span> <span class="n">tadbit</span> <span class="n">mapper</span><span class="p">)</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">resolution</span> <span class="n">INT</span>
                           <span class="n">resolution</span> <span class="n">at</span> <span class="n">which</span> <span class="n">to</span> <span class="n">output</span> <span class="n">matrices</span>
  <span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">text</span><span class="p">,</span><span class="n">matrix</span><span class="p">,</span><span class="n">cooler</span><span class="p">,</span><span class="n">hic</span><span class="p">}</span>
                           <span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="n">can</span> <span class="n">be</span> <span class="nb">any</span> <span class="n">of</span> <span class="p">[</span><span class="n">text</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">cooler</span><span class="p">,</span> <span class="n">hic</span><span class="p">]</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">STR</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span> <span class="n">STR</span>     <span class="n">path</span> <span class="n">to</span> <span class="n">output</span> <span class="n">file</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bam</span> <span class="n">PATH</span>               <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">TADbit</span><span class="o">-</span><span class="n">generated</span> <span class="n">BAM</span> <span class="n">file</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">reads</span> <span class="p">(</span><span class="n">other</span> <span class="n">wise</span> <span class="n">the</span>
                           <span class="n">tool</span> <span class="n">will</span> <span class="n">guess</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">database</span><span class="p">)</span>
  <span class="o">-</span><span class="n">j</span> <span class="n">INT</span><span class="p">,</span> <span class="o">--</span><span class="n">jobid</span> <span class="n">INT</span>      <span class="n">Use</span> <span class="k">as</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">a</span> <span class="n">job</span> <span class="k">with</span> <span class="n">a</span> <span class="n">given</span> <span class="n">jobid</span><span class="o">.</span> <span class="n">Use</span> <span class="n">tadbit</span>
                           <span class="n">describe</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">which</span><span class="o">.</span>
  <span class="o">--</span><span class="n">force</span>                  <span class="n">overwrite</span> <span class="n">previously</span> <span class="n">run</span> <span class="n">job</span>
  <span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">--</span><span class="n">quiet</span>              <span class="n">remove</span> <span class="nb">all</span> <span class="n">messages</span>
  <span class="o">--</span><span class="n">tmpdb</span> <span class="n">PATH</span>             <span class="k">if</span> <span class="n">provided</span> <span class="n">uses</span> <span class="n">this</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">the</span> <span class="n">database</span>
  <span class="o">--</span><span class="n">nchunks</span> <span class="n">NCHUNKS</span>        <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">chunks</span> <span class="n">into</span> <span class="n">which</span> <span class="n">to</span> <span class="n">cut</span> <span class="n">the</span> <span class="n">BAM</span>
  <span class="o">-</span><span class="n">C</span> <span class="n">CPUS</span><span class="p">,</span> <span class="o">--</span><span class="n">cpus</span> <span class="n">CPUS</span>     <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">host</span><span class="o">.</span> <span class="n">If</span>
                           <span class="n">higher</span> <span class="n">than</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tasks</span> <span class="k">with</span> <span class="n">multi</span><span class="o">-</span><span class="n">threading</span> <span class="n">capabilities</span> <span class="n">will</span> <span class="n">enabled</span>
                           <span class="p">(</span><span class="k">if</span> <span class="mi">0</span> <span class="nb">all</span> <span class="n">available</span><span class="p">)</span> <span class="n">cores</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">--</span><span class="n">chr_name</span> <span class="n">STR</span> <span class="p">[</span><span class="n">STR</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[</span><span class="n">fasta</span> <span class="n">header</span><span class="p">]</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span> <span class="n">Order</span> <span class="n">of</span> <span class="n">chromosomes</span> <span class="ow">in</span> <span class="n">the</span>
                           <span class="n">output</span> <span class="n">matrices</span><span class="o">.</span>
  <span class="o">--</span><span class="n">juicerjar</span> <span class="n">PATH</span>         <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">juicer</span> <span class="n">tools</span> <span class="n">jar</span> <span class="n">file</span> <span class="n">needed</span> <span class="n">to</span> <span class="n">export</span> <span class="n">matrices</span> <span class="n">to</span> <span class="n">hic</span>
                           <span class="nb">format</span> <span class="p">(</span><span class="n">check</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">aidenlab</span><span class="o">/</span><span class="n">juicer</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="n">Download</span><span class="p">)</span><span class="o">.</span>
                           <span class="n">Note</span> <span class="n">that</span> <span class="n">you</span> <span class="n">also</span> <span class="n">need</span> <span class="n">java</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">path</span><span class="o">.</span>

<span class="n">Read</span> <span class="n">filtering</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">F</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">],</span> <span class="o">--</span><span class="nb">filter</span> <span class="n">INT</span> <span class="p">[</span><span class="n">INT</span> <span class="o">...</span><span class="p">]</span>
                           <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span> <span class="n">Use</span> <span class="n">filters</span> <span class="n">to</span> <span class="n">define</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">valid</span>
                           <span class="n">pair</span> <span class="n">of</span> <span class="n">reads</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;--filter 1 2 3 4 8 9 10&#39;</span><span class="o">.</span> <span class="n">Where</span> <span class="n">these</span> <span class="n">numbers</span>
                           <span class="n">correspond</span> <span class="n">to</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">nothing</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="n">circle</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>
                           <span class="n">error</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="n">extra</span> <span class="n">dangling</span><span class="o">-</span><span class="n">end</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="n">too</span> <span class="n">close</span> <span class="kn">from</span> <span class="nn">RES</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="n">too</span> <span class="n">short</span><span class="p">,</span>
                           <span class="mi">7</span><span class="p">:</span> <span class="n">too</span> <span class="n">large</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">over</span><span class="o">-</span><span class="n">represented</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="n">duplicated</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="n">random</span> <span class="n">breaks</span><span class="p">,</span>
                           <span class="mi">11</span><span class="p">:</span> <span class="n">trans</span><span class="o">-</span><span class="n">chromosomic</span>

<span class="n">Normalization</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">biases</span> <span class="n">PATH</span>            <span class="n">path</span> <span class="n">to</span> <span class="n">file</span> <span class="k">with</span> <span class="n">pre</span><span class="o">-</span><span class="n">calculated</span> <span class="n">biases</span> <span class="n">by</span> <span class="n">columns</span>
  <span class="o">--</span><span class="n">norm</span>                   <span class="n">export</span> <span class="n">normalized</span> <span class="n">matrix</span>

<span class="n">Output</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">--</span><span class="n">rownames</span>               <span class="n">To</span> <span class="n">store</span> <span class="n">row</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">output</span> <span class="n">text</span> <span class="n">matrix</span><span class="o">.</span> <span class="n">WARNING</span><span class="p">:</span> <span class="n">when</span> <span class="n">non</span><span class="o">-</span>
                           <span class="n">matrix</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">two</span> <span class="n">extra</span> <span class="n">columns</span>
  <span class="o">-</span><span class="n">c</span> <span class="p">,</span> <span class="o">--</span><span class="n">coord</span>             <span class="n">Coordinate</span> <span class="n">of</span> <span class="n">the</span> <span class="n">region</span> <span class="n">to</span> <span class="n">retrieve</span><span class="o">.</span> <span class="n">By</span> <span class="n">default</span> <span class="nb">all</span> <span class="n">genome</span><span class="p">,</span>
                           <span class="n">arguments</span> <span class="n">can</span> <span class="n">be</span> <span class="n">either</span> <span class="n">one</span> <span class="n">chromosome</span> <span class="n">name</span><span class="p">,</span> <span class="ow">or</span> <span class="n">the</span> <span class="n">coordinate</span> <span class="ow">in</span>
                           <span class="n">the</span> <span class="n">form</span><span class="p">:</span> <span class="s2">&quot;-c chr3:110000000-120000000&quot;</span>
  <span class="o">-</span><span class="n">c2</span> <span class="p">,</span> <span class="o">--</span><span class="n">coord2</span>           <span class="n">Coordinate</span> <span class="n">of</span> <span class="n">a</span> <span class="n">second</span> <span class="n">region</span> <span class="n">to</span> <span class="n">retrieve</span> <span class="n">the</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">the</span>
                           <span class="n">intersection</span> <span class="k">with</span> <span class="n">the</span> <span class="n">first</span> <span class="n">region</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/TADbit_logo_little.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing TADbit on GNU/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TADbit tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-map">TADbit map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-parse">TADbit parse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-filter">TADbit filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-normalize">TADbit normalize</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-bin">TADbit bin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-segment">TADbit segment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-model">TADbit model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-merge">TADbit merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-describe">TADbit describe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-clean">TADbit clean</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-import">TADbit import</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tadbit-export">TADbit export</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">Reference Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial/tutorial_11-3D_Models_production_and_analysis.html"
                        title="previous chapter">Modelling a region of the chromatin</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference/index.html"
                        title="next chapter">Reference Guide</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="reference/index.html" title="Reference Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial/tutorial_11-3D_Models_production_and_analysis.html" title="Modelling a region of the chromatin"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">TADbit 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">TADbit tools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Last updated on Mar 07, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div><style>div.related ul {padding-right:150px;}</style>
        <a href="https://github.com/3DGenomes/tadbit" target="_blank"><img
            style="position: absolute; top: 0; right: 0; border: 0;"
            src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
</html>