"""
This is to quickly test eqv_rms_drms.rmsdRMSD_wrapper function.
just compile with:
g++ -shared eqv_rms_drms_py.cpp -I/usr/include/python2.7 -lm -lpthread  -fPIC -g -O3 -Wall -o eqv_rms_drms.so
g++ -shared centroid_py.cpp -I/usr/include/python2.7 -lm -lpthread  -fPIC -g -O3 -Wall -o centroid.so
and run this test as:
python test.py
or through gdb:
gdb python -ex 'run test.py'
"""

import eqv_rms_drms
from pytadbit.imp.impmodel import IMPmodel


models = ['2', '3', '4', '5', '8']

lists = {}
for model in models:
    lists[model] = []
    for line in open ('test/model.{}.xyz'.format(model)):
        _, _, x, y, z = line.split()
        lists[model].append((float(x), float(y), float(z)))
    lists[model] = [list(i) for i in zip(*lists[model])]
    
for model1 in ['2', '3', '4', '5', '8']:
    for model2 in ['2', '3', '4', '5', '8']:
        print model1, model2, eqv_rms_drms.rmsdRMSD_wrapper(lists[model1][0], lists[model1][1], lists[model1][2], lists[model2][0], lists[model2][1], lists[model2][2],
                                                            len(lists[model1][0]),
                                                            200., 0)

print 'finished test'


import centroid

from itertools import permutations

for m1, m2, m3, m4, m5 in permutations(models, 5):
    
    # print m1, m2, m3, m4, m5
    models2 = [m1, m2, m3, m4, m5]
    lala = centroid.centroid_wrapper([lists[m1][0], lists[m2][0], lists[m3][0], lists[m4][0], lists[m5][0]],
                                     [lists[m1][1], lists[m2][1], lists[m3][1], lists[m4][1], lists[m5][1]],
                                     [lists[m1][2], lists[m2][2], lists[m3][2], lists[m4][2], lists[m5][2]],
                                     len(lists['2'][0]), 5, 0, 0)
    print '   ====>>>> ', models2[lala]


avg = centroid.centroid_wrapper([lists[m1][0], lists[m2][0], lists[m3][0], lists[m4][0], lists[m5][0]],
                                [lists[m1][1], lists[m2][1], lists[m3][1], lists[m4][1], lists[m5][1]],
                                [lists[m1][2], lists[m2][2], lists[m3][2], lists[m4][2], lists[m5][2]],
                                len(lists['2'][0]), 5, 0, 1)

avgmodel = IMPmodel((('x', avg[0]), ('y', avg[1]), ('z', avg[2]),
                     ('rand_init', 'avg'), ('objfun', None)))
avgmodel.write_cmm('test/')


exit()


lala = centroid.centroid_wrapper([lists['2'][0], lists['3'][0], lists['4'][0], lists['5'][0], lists['8'][0]],
                                 [lists['2'][1], lists['3'][1], lists['4'][1], lists['5'][1], lists['8'][1]],
                                 [lists['2'][2], lists['3'][2], lists['4'][2], lists['5'][2], lists['8'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]


lala = centroid.centroid_wrapper([lists['4'][0], lists['3'][0], lists['5'][0], lists['8'][0], lists['2'][0]],
                                 [lists['4'][1], lists['3'][1], lists['5'][1], lists['8'][1], lists['2'][1]],
                                 [lists['4'][2], lists['3'][2], lists['5'][2], lists['8'][2], lists['2'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]


lala = centroid.centroid_wrapper([lists['2'][0], lists['8'][0], lists['5'][0], lists['4'][0], lists['3'][0]],
                                 [lists['2'][1], lists['8'][1], lists['5'][1], lists['4'][1], lists['3'][1]],
                                 [lists['2'][2], lists['8'][2], lists['5'][2], lists['4'][2], lists['3'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]






import centroid

from itertools import permutations

for m1, m2, m3, m4, m5 in permutations(models, 5):
    
    print m1, m2, m3, m4, m5
    lala = centroid.centroid_wrapper([lists[m1][0], lists[m2][0], lists[m3][0], lists[m4][0], lists[m5][0]],
                                     [lists[m1][1], lists[m2][1], lists[m3][1], lists[m4][1], lists[m5][1]],
                                     [lists[m1][2], lists[m2][2], lists[m3][2], lists[m4][2], lists[m5][2]],
                                     len(lists['2'][0]), 5, 1)
    print '   ====>>>> ', models[lala]


lala = centroid.centroid_wrapper([lists['2'][0], lists['3'][0], lists['4'][0], lists['5'][0], lists['8'][0]],
                                 [lists['2'][1], lists['3'][1], lists['4'][1], lists['5'][1], lists['8'][1]],
                                 [lists['2'][2], lists['3'][2], lists['4'][2], lists['5'][2], lists['8'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]


lala = centroid.centroid_wrapper([lists['4'][0], lists['3'][0], lists['5'][0], lists['8'][0], lists['2'][0]],
                                 [lists['4'][1], lists['3'][1], lists['5'][1], lists['8'][1], lists['2'][1]],
                                 [lists['4'][2], lists['3'][2], lists['5'][2], lists['8'][2], lists['2'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]


lala = centroid.centroid_wrapper([lists['2'][0], lists['8'][0], lists['5'][0], lists['4'][0], lists['3'][0]],
                                 [lists['2'][1], lists['8'][1], lists['5'][1], lists['4'][1], lists['3'][1]],
                                 [lists['2'][2], lists['8'][2], lists['5'][2], lists['4'][2], lists['3'][2]],
                                 len(lists['2'][0]), 5, 1)
print models[lala]


xyz = [[255.205, -134.756, -135.035],
[183.429, -143.616, -96.9511],
[115.564, -27.1017, -60.624],
[219.793, -202.912, -58.3896],
[134.996, -263.812, 23.2011],
[89.82, -107.806, -85.8345],
[122.598, -171.746, -76.9705],
[-48.9865, -136.803, -8.08944],
[94.3814, -258.123, -63.2573],
[101.955, -328.464, -60.8206],
[83.8422, -293.485, -88.291],
[75.3487, -151.791, -53.0038],
[35.4459, -316.719, -13.8013],
[-2.76054, -275.127, 61.5165],
[2.20117, -252.259, 5.78667],
[54.6222, -34.7706, -30.8456],
[162.317, -92.1274, 13.3825],
[146.639, -80.8969, -79.7594],
[2.11769, -41.7822, -43.4619],
[129.742, -92.6761, -119.918],
[193.765, -155.666, -69.4038],
[179.188, -169.56, -32.0903],
[196.317, -217.043, -64.4574],
[90.9612, -78.2858, 6.0633],
[131.573, -262.34, 2.40122],
[111.333, -59.5375, 22.8258],
[172.315, -85.7401, -65.0388],
[246.03, -122.969, -157.664],
[290.493, -192.613, -175.072],
[331.547, -235.153, -148.131],
[263.194, -224.464, -32.0492],
[20.5886, -84.1326, 12.3069],
[34.6363, -329.186, -44.3252],
[58.6941, -119.683, -84.5415],
[108.887, -70.086, -24.0661],
[173.058, -224.51, 10.5514],
[111.055, -148.394, -11.8456],
[176.303, -137.028, 3.39619],
[282.601, -259.66, -55.56],
[305.745, -125.287, -77.1379],
[198.553, -13.3499, -26.0586],
[291.664, -61.6366, -58.5865],
[237.509, -82.5713, -42.3788],
[449.833, -98.4252, -53.9292],
[330.31, -122.819, -27.2686],
[226.45, -71.245, 11.3172],
[127.373, -252.691, 17.2758],
[62.2133, -223.323, 56.4903],
[-27.7198, -301.311, 51.1269],
[152.189, -242.767, 3.77048],
[169.121, -471.026, 46.4433],
[112.897, -411.454, 50.2482],
[100.584, -351.906, 26.4273],
[-4.06037, -446.801, 93.4291],
[42.8648, -512.439, 156.647],
[-41.6357, -297.557, 139.983],
[6.56184, -316.142, 215.486],
[162.022, -425.001, 231.983],
[90.6442, -318.44, 164.57],
[130.477, -486.354, 147.183],
[74.1756, -370.422, 124.051],
[117.824, -351.762, 86.7308],
[218.92, -379.264, 27.2417],
[177.869, -200.313, 11.8216],
[163.971, -174.583, 56.0531],
[154.881, -222.345, 63.8862],
[99.3551, -46.6867, 53.3928],
[106.319, -184.994, 15.3585],
[20.7708, -54.2095, 33.0766],
[82.3245, -174.01, 53.1078],
[33.381, -260.292, 77.4469],
[178.071, -354.474, 105.682],
[311.232, -412.036, 64.0729],
[194.196, -505.503, 118.138],
[324.408, -374.103, 76.3623],
[219.172, -278.204, 46.5766],
[154.068, -391.684, 62.5194],
[275.273, -417.283, 102.191],
[339.499, -263.231, 55.5621],
[137.985, -115.383, 86.5714],
[278.613, -142.949, 94.9173],
[188.184, -131.036, 81.2907],
[98.3721, -128.765, 0.546159],
[255.35, -169.339, -44.6966],
[367.718, -250.928, -58.9605],
[249.381, -234.666, 0.50558],
[72.4502, -189.547, 60.986],
[76.3842, -298.515, 63.3882],
[-17.6213, -221.608, 81.039],
[118.207, -298.609, 93.2406],
[287.331, -279.561, 55.9668],
[55.112, -128.357, 24.0379],
[148.893, -30.9453, -16.2583],
[167.794, -61.8346, 8.1697],
[254.59, -210.5, 17.7557],
[296.264, -308.875, 30.3889],
[122.237, -298.159, 15.7696],
[94.4611, -191.145, 16.6073],
[173.468, -192.366, 93.0606],
[174.011, -437.722, 142.28],
[74.3548, -415.264, 72.1222],
[144.068, -404.032, 17.082],
[107.918, -421.876, 126.996],
[-29.5112, -477.713, 145.808],
[-30.4015, -426.016, 108.111],
[-41.7321, -266.469, 82.4225],
[-15.339, -411.423, 83.7222],
[-72.0709, -312.009, 103.027],
[-117.215, -512.935, 166.399],
[37.6021, -368.27, 160.872],
[-49.3405, -401.705, 127.749],
[46.909, -548.454, 201.078],
[27.1623, -431.563, 158.081],
[43.9999, -263.162, 67.4033],
[-70.2272, -407.876, 130.006],
[32.8067, -444.394, 141.263],
[-47.9388, -509.734, 213.711],
[13.9356, -494.326, 112.019],
[33.3045, -539.465, 152.454],
[92.7414, -434.641, 139.007],
[51.9431, -179.524, 55.1363],
[-63.4556, -171.991, 211.734],
[64.8657, -243.05, 138.724],
[-98.5551, -306.38, 189.372],
[-78.9631, -152.16, 45.2744],
[-128.307, -373.826, 166.25],
[-92.8147, -463.948, 138.161],
[12.6752, -429.704, 107.345],
[-48.0087, -390.415, 153.376],
[30.2872, -189.593, 130.051],
[130.216, -317.083, 123.046],
[-0.0216034, -117.834, 61.8996],
[-29.0194, -255.193, 48.2299],
[-46.444, -78.7481, 53.6035],
[-60.425, -252.809, 118.404],
[-126.887, -275.633, 119.067],
[-160.301, -117.09, 124.317],
[-62.3779, -106.89, -3.60024],
[-94.6367, -160.839, -14.5749],
[-183.218, -167.348, 91.1585],
[-125.736, -260.005, 65.1962],
[-169.394, -282.642, 139.134],
[-130.096, -98.7421, 61.8003],
[-192.826, -154.268, 46.3781],
[-174.395, -304.114, 26.4937],
[-209.113, -333.206, 144.869],
[-288.901, -360.562, 158.006],
[-268.088, -446.153, 208.837],
[-280.411, -351.873, 216.115],
[-309.641, -199.524, 114.721],
[-314.599, -125.345, 87.0535],
[-229.923, -209.338, 122.185],
[-200.768, -239.407, 102.102],
[-195.564, -450.381, 144.391],
[-294, -406.623, 164.685],
[-213.619, -274.043, 93.9865],
[-276.467, -445.178, 162.554],
[-293.466, -373.466, 111.627],
[-293.776, -368.588, 166.443],
[-241.211, -266.144, 87.3963],
[-262.529, -187.314, 114.513],
[-337.179, -87.4501, 143.618],
[-410.155, -145.749, 159.294],
[-338.107, -188.633, 210.083],
[-203.763, -301.569, 113.105],
[-154.111, -107.423, 72.7508],
[-234.234, -91.186, 67.717],
[-422.457, -203.825, 123.709],
[-466.432, -201.738, 170.128],
[-426.508, -32.4718, 79.6078],
[-540.919, -160.437, 111.498],
[-444.054, -53.4921, 32.7903],
[-357.994, -43.5222, 87.2119],
[-352.029, -160.817, 65.0055],
[-470, -321.647, 134.57],
[-303.808, -280.463, 75.4525],
[-297.751, -164.169, 136.082],
[-341.793, -324.895, 108.627],
[-248.419, -230.317, 157.835],
[-405.949, -200.488, 176.895],
[-550.206, -192.44, 88.4218],
[-461.664, -37.702, 68.467],
[-235.916, -13.5005, 69.3298],
[-343.408, -29.7117, 148.632],
[-425.699, -136.873, 137.511],
[-302.956, 2.11789, 134.611],
[-239.884, -58.8552, 66.3424],
[-218.299, -148.325, 168.695],
[-122.506, -66.8818, 123.127],
[-195.319, -209.759, 134.941],
[-127.16, -98.1387, 62.7645],
[-203.1, -307.254, 148.67],
[-135.082, -128.571, 147.832],
[-265.986, -232.204, 146.726],
[-148.142, -87.7363, 30.3216],
[-220.393, -188.373, -2.51924],
[-74.0623, -19.3734, 25.1213],
[-199.9, -255.041, 40.3086],
[-161.018, -65.1278, -58.4481],
[-223.321, -111.406, 10.0208],
[-389.243, -237.87, 138.22],
[-362.956, -95.6778, 149.023],
[-234.133, 18.7998, 127.812],
[-369.519, 7.82174, 193.472],
[-369.507, -39.8398, 67.9716],
[-505.069, -5.35448, 101.779],
[-412.483, -162.497, 67.9341],
[-142.303, 33.0046, -36.4466],
[-165.002, 42.4547, 46.3246],
[-267.681, 24.772, -5.9358],
[-466.391, -63.8562, 4.39064],
[-264.773, 51.9737, 12.592],
[-363.116, 78.1559, 12.2378],
[-239.375, 27.7297, 97.4632],
[-342.143, -94.4262, 155.907],
[-305.238, 67.4005, 165.388],
[-433.342, -43.7233, 79.7256],
[-488.325, -6.14467, -8.27143],
[-327.14, 44.8789, -70.5192],
[-342.914, -60.4669, -55.284],
[-173.108, -4.05449, -44.6744],
[-243.932, -111.883, 49.5234],
[-296.572, -19.3844, -6.16614],
[-377.883, 20.5293, 52.3334],
[-200.688, 114.871, 84.7765],
[-238.447, 33.2506, -0.804311],
[-337.301, -1.09253, -23.1444],
[-466.676, 31.8401, 103.982],
[-428.141, 42.2397, 189.072],
[-443.682, -57.1354, 195.104],
[-479.705, 93.0936, 168.911],
[-542.189, 98.4368, 153.089],
[-428.973, 129.075, 128.834],
[-367.498, 47.1238, 163.24],
[-350.798, 25.7331, 210.858],
[-241.291, 20.9771, 172.607],
[-351.855, 34.0446, 239.409],
[-384.621, 43.0652, 254.331],
[-316.534, 31.7483, 197.714],
[-273.291, -33.8605, 161.792],
[-122.879, 55.1637, 86.9296],
[-109.807, 114.536, 172.405],
[-201.453, -2.46881, 305.597],
[-147.538, 187.79, 305.11],
[-314.059, 189.008, 399.663],
[-321.46, 201.635, 314.291],
[-260.871, 191.896, 186.705],
[-245.437, -45.1122, 199.65],
[-194.301, -11.7443, 111.075],
[-53.4108, 91.3153, 86.8151],
[-97.742, 74.9943, 173.482],
[-221.403, 118.479, 189.69],
[-78.3132, 179.706, 212.25],
[-181.309, 178.017, 181.712],
[-140.027, 220.29, 114.849],
[-172.512, 66.3335, 68.73],
[-83.926, 90.9454, 66.7028],
[-216.294, 39.7476, 211.843],
[-136.75, 120.66, 120.412],
[-269.569, 52.2425, 240.757],
[-159.726, 164.664, 179.764],
[-288.473, 144.324, 275.669],
[-271.662, 165.984, 281.706],
[-266.489, 178.863, 356.351],
[-342.312, 183.208, 304.737],
[-245.433, 279.767, 270.597],
[-310.17, 221.587, 208.101],
[-260.22, 215.119, 229.004],
[-145.675, 181.512, 151.7],
[-256.52, 298.01, 257.041],
[-154.278, 249.868, 85.8675],
[-297.499, 274.45, 188.045],
[-159.889, 194.97, 136.527],
[-298.106, 236.967, 286.719],
[-238.385, 235.406, 228.267],
[-241.073, 172.521, 249.473],
[-128.643, 203.266, 90.3413],
[-149.801, 275.613, 121.824],
[-193.988, 401.603, 197.368],
[-121.177, 302.281, 93.7681],
[-61.5803, 180.82, 137.526],
[-159.172, 253.408, 274.53],
[-105.504, 296.578, 222.048],
[-147.086, 361.165, 166.816],
[-143.468, 152.127, 121.397],
[-88.8977, 135.399, 36.2081],
[-64.4013, 180.316, 116.663],
[-73.0269, 114.367, 9.11028],
[-54.1005, 70.1883, 47.9117],
[-49.2844, 131.1, 18.8919],
[-122.492, 90.2932, -7.25525],
[-88.8202, 85.9666, -2.64862],
[-147.313, 185.825, 68.1907],
[-69.8026, 253.809, 88.6882],
[64.2453, 199.001, -3.77791],
[3.2413, 299.242, 5.83445],
[-79.4126, 325.983, 165.389],
[-73.3853, 276.886, 133.198],
[-15.3917, 166.83, 33.1616],
[-206.158, 89.0689, 87.2602],
[-181.047, 222.371, 42.0693],
[-103.7, 174.175, 53.9072],
[-84.6579, 300.408, 31.7697],
[-129.237, 317.442, 93.879],
[0.0418388, 286.59, 74.7581],
[13.8433, 115.096, 146.674],
[-60.6945, 28.8627, 127.196],
[8.39598, 100.544, 43.5833],
[-22.6321, 97.8733, 39.1358],
[-72.4902, 213.595, 45.5717],
[64.1193, 151.318, -43.0509],
[-21.8191, 200.173, -0.0606857],
[-66.4506, 134.746, 12.5631],
[103.504, 154.838, -40.0758],
[-16.0173, 127.96, -2.21889],
[53.7045, 79.5578, -37.8095],
[23.3724, 261.504, 74.0519],
[-46.1939, 397.931, -8.68015],
[-53.1918, 411.684, -32.4427],
[-115.377, 297.379, -10.7162],
[-70.5159, 328.897, -41.7121],
[-90.2363, 329.133, 8.56441],
[7.16305, 255.434, -102.23],
[-79.0529, 303.182, -106.973],
[33.4428, 210.877, -40.3987],
[52.7903, 200.764, 24.9313],
[106.296, 304.745, -60.007],
[88.3077, 215.639, -29.8712],
[32.9488, 367.296, -36.7971],
[-62.9368, 447.057, 55.1505],
[-84.3079, 485.97, -4.61301],
[-60.874, 323.044, 65.4161],
[50.5324, 161.353, -14.566],
[21.374, 112.417, -51.9777],
[-13.7746, 170.562, -9.39063],
[-14.5764, 371.862, 28.5627],
[172.184, 361.138, 3.83599],
[242.995, 285.188, -42.1373],
[235.472, 443.842, -63.9389],
[125.93, 562.074, 1.42461],
[61.3713, 510.46, 89.4592],
[134.512, 408.047, 28.0411],
[88.0464, 351.054, 37.8941],
[59.3864, 250.905, 117.414],
[100.25, 370.81, -8.29849],
[37.3527, 447.303, 54.3121],
[136.215, 295.43, 98.2492],
[170.031, 171.36, 10.9662],
[227.956, 277.434, -98.8219],
[190.59, 498.316, -11.0981],
[126.263, 540.587, 25.3483],
[18.7688, 425.369, 7.7687],
[65.9084, 302.999, 14.773],
[-64.5615, 357.15, 55.8688],
[-136.049, 397.254, 131.24],
[-76.3632, 489.454, 23.5234],
[38.7753, 541.42, -101.525],
[22.6758, 454.776, -114.195],
[52.4084, 509.298, -2.11293],
[-9.92527, 338.857, -48.3895],
[65.4729, 398.783, -149.366],
[144.525, 276.706, -128.69],
[127.306, 106.84, -77.1947],
[90.1047, 236.659, -99.6516],
[45.051, 378.352, -75.4005],
[99.7165, 286.622, -44.2225],
[54.3182, 189.911, -57.5958],
[12.8974, 153.162, -7.88015],
[56.769, 235.38, -53.2234],
[54.673, 376.745, -49.3704],
[215.48, 313.471, -115.936],
[259.035, 380.936, -177.275],
[199.602, 416.357, -250.002],
[164.917, 346.731, -234.3],
[128.873, 217.037, -243.227],
[185.231, 151.733, -147.031],
[144.878, 83.4346, -101.118],
[112.934, 66.2018, -160.972],
[109.032, 118.354, -89.2841],
[153.792, 82.2533, -191.007],
[201.476, 207.92, -156.014],
[198.661, 85.5918, -165.233],
[274.762, 35.4142, -264.824],
[249.591, 49.7996, -245.322],
[220.523, 130.787, -242.635],
[303.446, 30.8234, -257.509],
[419.768, -10.5087, -249.387],
[312.271, -66.1442, -246.327],
[319.162, -20.4584, -159.344],
[291.388, 67.5287, -145.385],
[306.358, 94.613, -218.915],
[413.741, 107.551, -270.093],
[339.06, 246.56, -262.96],
[344.381, 197.192, -277.11],
[308.289, 276.101, -237.558],
[371.466, 158.21, -285.72],
[218.409, 115.666, -203.425],
[377.361, 70.7194, -305.098],
[473.104, 107.969, -392.79],
[336.314, 162.66, -343.182],
[358.91, 266.867, -338.53],
[411.316, 183.301, -348.859],
[328.427, 217.349, -283.573],
[460.458, 192.47, -414.568],
[422.798, 218.69, -389.338],
[441.936, 212.908, -424.655],
[325.135, 183.791, -331.094],
[210.389, 95.6709, -248.301],
[223.299, 201.988, -285.746],
[315.53, 309.405, -244.104],
[231.652, 162.276, -161.327],
[330.154, 167.968, -275.322],
[259.851, 178.634, -256.949],
[241.479, 136.331, -197.035],
[263.659, 180.703, -280.771],
[368.949, 284.035, -367.891],
[454.483, 165.189, -446.893],
[369.641, 160.593, -316.038],
[394.379, 72.6344, -407.698],
[374.475, 56.5044, -350.342],
[282.209, -39.8728, -246.594],
[154.385, 78.5476, -156.53],
[217.198, 47.6022, -208.204],
[303.101, 184.813, -235.243],
[244.008, 190.628, -228.305],
[221.593, 263.108, -245.906],
[121.263, 167.488, -123.406],
[232.472, 210.098, -223.702],
[360.738, 173.3, -345.806],
[369.561, 89.028, -413.431],
[393.341, 112.592, -376.049],
[234.143, 76.8731, -278.48],
[113.378, 16.3361, -134.822],
[256.887, -24.5393, -160.775],
[236.661, -1.1919, -226.456],
[194.033, 49.6007, -225.724],
[211.517, 90.6615, -193.418],
[191.107, 30.5965, -175.724],
[319.613, -6.90539, -306.659],
[330.421, -79.047, -274.962],
[326.781, 84.073, -322.756],
[176.5, -11.2525, -204.843],
[89.0516, 54.9791, -153.007],
[132.088, -34.6459, -209.318],
[30.4077, 97.6969, -129.002],
[190.606, 21.8284, -219.662],
[254.244, 154.334, -259.23],
[202.661, 103.101, -213.014],
[244.961, 118.335, -246.471],
[122.658, 132.8, -256.413],
[168.501, 164.698, -228.885],
[112.965, 194.393, -273.503],
[234.951, 110.42, -351.26],
[105.481, 129.992, -240.691],
[228.004, 115.129, -360.165],
[124.28, 87.4088, -250.985],
[133.844, 65.2966, -250.56],
[173.794, 154.416, -298.484],
[260.426, 137.867, -341.276],
[258.508, 270.239, -324.76],
[222.617, 164.641, -244.208],
[96.245, 73.5948, -134.804],
[143.56, 106.011, -147.075],
[110.509, -1.12265, -97.9566],
[29.0834, 124.947, -106.259],
[59.6068, 199.763, -212.757],
[47.9539, 203.031, -128.377],
[115.762, 329.187, -141.693],
[-38.9711, 321.382, -112.487],
[4.49122, 213.649, -113.736],
[-1.88824, 233.761, -123.699],
[-19.4626, 241.95, -123.591],
[-63.5821, 196.722, -66.0854],
[-76.3693, 136.762, -18.4723],
[-83.6806, 151.897, -67.3304],
[-73.9277, 104.548, -70.7216],
[-48.4118, 179.447, -95.6355],
[1.60955, 157.25, -27.944],
[29.1078, 162.619, -144.536],
[-34.2214, 240.043, -160.846],
[91.9638, 262.848, -206.207]]


lists['avg'] = zip(*xyz)


head = '<marker_set name="{}">\n'
mark = '<marker id="{0}" x="{1}" y="{2}" z="{3}" r="0.1" g="0" b="1" radius="10" note="{0}"/>\n'
link = '<link id1="{}" id2="{}" r="1" g="1" b="1" radius="5"/>\n'
end = '</marker_set>\n'
for model in models + ['avg']:
    out = open('model.{}.cmm'.format(model), 'w')
    out.write(head.format(model))
    for i, (x, y, z) in enumerate(zip(*lists[model])):
        out.write(mark.format(i+1, x,y,z))
    for i in range(len(lists[model][0])-1):
        out.write(link.format(i+1, i+2))
    out.write(end)
    out.close()


import os
from cPickle import load
mpath = '/scratch/shared/TADs/T0/models/'
for rep in os.listdir(mpath):
    if not rep.startswith('T0'):
        continue
    print '-'*80
    svn = load(open(mpath + rep + '/'+rep+'.models'))
    print ' '.join(svn.keys())
    
    print mpath
    for fnam in os.listdir(mpath + rep):
        print fnam
