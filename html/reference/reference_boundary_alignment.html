
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Alignment class &mdash; Tadbit 0.1 documentation</title>
    
    <link rel="stylesheet" href="../static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Tadbit 0.1 documentation" href="../index.html" />
    <link rel="up" title="Reference Guide" href="index.html" />
    <link rel="next" title="Generate a 3D models" href="reference_imp.html" />
    <link rel="prev" title="Boundary Aligner" href="reference_aligner.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="reference_imp.html" title="Generate a 3D models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reference_aligner.html" title="Boundary Aligner"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Tadbit 0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Reference Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="alignment-class">
<h1>Alignment class<a class="headerlink" href="#alignment-class" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pytadbit.alignment.Alignment">
<em class="property">class </em><tt class="descclassname">pytadbit.alignment.</tt><tt class="descname">Alignment</tt><big>(</big><em>name</em>, <em>alignment</em>, <em>experiments</em>, <em>score=None</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="pytadbit.alignment.Alignment.draw">
<tt class="descname">draw</tt><big>(</big><em>focus=None</em>, <em>extras=None</em>, <em>savefig=None</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw alignments as a plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>focus</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; can pass a tuple (bin_start, bin_stop) to display the
alignment between these genomic bins</li>
<li><strong>extras</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; list of coordinates (genomic bin) where to draw a
red cross</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pytadbit.alignment.Alignment.get_column">
<tt class="descname">get_column</tt><big>(</big><em>cond1</em>, <em>cond2=None</em>, <em>min_num=None</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.get_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.get_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of column responding to a given characteristic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cond1</strong> &#8211; can be either a column number or a function to search for
a given condition that may fulfill boundaries.</li>
<li><strong>cond2</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; a second function to search for a given condition
that may fulfill boundaries.</li>
<li><strong>min_num</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; Number of boundaries in a given column that have to
pass the defined conditions (all boundaries may pass them by default).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a list of column, each column represented by a tuple which
first element is the column number in the alignment and second
element is the list of boundaries in this column.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ali</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="s">&#39;ALL&#39;</span><span class="p">,</span> <span class="n">crm</span><span class="o">.</span><span class="n">get_alignment</span><span class="p">(</span><span class="s">&#39;ALL&#39;</span><span class="p">),</span>
                <span class="n">crm</span><span class="o">.</span><span class="n">experiments</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
<span class="n">ali</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c"># [(3, [&gt;55&lt;, ,&gt;56&lt;, &gt;55&lt;, &gt;58&lt;])]</span>

<span class="c"># now we want boundaries with high scores</span>
<span class="n">cond1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;score&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span>
<span class="c"># and we want boundaries to be detected in Experiments exp1 and exp2</span>
<span class="n">cond2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;exp&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;exp1&#39;</span><span class="p">,</span> <span class="s">&#39;exp2&#39;</span><span class="p">]</span>

<span class="n">ali</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="n">cond1</span><span class="o">=</span><span class="n">cond1</span><span class="p">,</span> <span class="n">cond2</span><span class="o">=</span><span class="n">cond2</span><span class="p">,</span> <span class="n">min_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c"># [(33, [&gt;268&lt;, &gt;192&lt;, &gt;-&lt;, &gt;-&lt;]),     </span>
<span class="c">#  (46, [&gt;324&lt;, &gt;323&lt;, &gt;335&lt;, &gt;329&lt;]), </span>
<span class="c">#  (51, [&gt;348&lt;, &gt;335&lt;, &gt;357&lt;, &gt;347&lt;]), </span>
<span class="c">#  (56, [&gt;374&lt;, &gt;358&lt;, &gt;383&lt;, &gt;-&lt;]),   </span>
<span class="c">#  (64, [&gt;397&lt;, &gt;396&lt;, &gt;407&lt;, &gt;-&lt;]),   </span>
<span class="c">#  (77, [&gt;444&lt;, &gt;442&lt;, &gt;456&lt;, &gt;-&lt;])]   </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pytadbit.alignment.Alignment.itercolumns">
<tt class="descname">itercolumns</tt><big>(</big><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.itercolumns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.itercolumns" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over columns in the alignment</p>
</dd></dl>

<dl class="method">
<dt id="pytadbit.alignment.Alignment.iteritems">
<tt class="descname">iteritems</tt><big>(</big><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.iteritems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.iteritems" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over experiment names and aligned boundaries</p>
</dd></dl>

<dl class="method">
<dt id="pytadbit.alignment.Alignment.itervalues">
<tt class="descname">itervalues</tt><big>(</big><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.itervalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.itervalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over experiment names and aligned boundaries</p>
</dd></dl>

<dl class="method">
<dt id="pytadbit.alignment.Alignment.write_alignment">
<tt class="descname">write_alignment</tt><big>(</big><em>names=None</em>, <em>xpers=None</em>, <em>string=False</em>, <em>title=''</em>, <em>ftype='ansi'</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#Alignment.write_alignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.Alignment.write_alignment" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Print alignment of TAD boundaries between different experiments.</dt>
<dd>Alignment are displayed with colors according to the tadbit
confidence score for each boundary.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>names</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; if None print all experiments</li>
<li><strong>xpers</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; if None print all experiments</li>
<li><strong>string</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><em>False</em></a>) &#8211; return string instead of printing</li>
<li><strong>ftype</strong> (<em>ansi</em>) &#8211; display colors in &#8216;ansi&#8217; or &#8216;html&#8217; format</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pytadbit.alignment.TAD">
<em class="property">class </em><tt class="descclassname">pytadbit.alignment.</tt><tt class="descname">TAD</tt><big>(</big><em>thing</em>, <em>i</em>, <em>exp</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#TAD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.TAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Specific class of TADs, used only within Alignment objects.
It is directly inheriting from python dict.
a TAD these keys:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;start&#8217;: position of the TAD</li>
<li>&#8216;end&#8217;: position of the TAD</li>
<li>&#8216;score&#8217;: of the prediction of boundary</li>
<li>&#8216;brk&#8217;: same as &#8216;end&#8217;</li>
<li>&#8216;pos&#8217;: in the alignment (column number)</li>
<li>&#8216;exp&#8217;: Experiment this TAD belongs to</li>
<li>&#8216;index&#8217;: of this TAD within all TADs in the Experiment</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pytadbit.alignment.randomization_test">
<tt class="descclassname">pytadbit.alignment.</tt><tt class="descname">randomization_test</tt><big>(</big><em>xpers</em>, <em>score=None</em>, <em>num=1000</em>, <em>verbose=False</em>, <em>max_dist=100000</em>, <em>rnd_method='interpolate'</em>, <em>r_size=None</em>, <em>method='reciprocal'</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#randomization_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.randomization_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the probability that original alignment is better than an
alignment of randomized boundaries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tads</strong> &#8211; original TADs of each experiment to align</li>
<li><strong>distr</strong> &#8211; the function to interpolate TAD lengths from probability</li>
<li><strong>score</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; just to print it when verbose</li>
<li><strong>num</strong> (<em>1000</em>) &#8211; number of random alignment to generate for comparison</li>
<li><strong>verbose</strong> (<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><em>False</em></a>) &#8211; to print something nice</li>
<li><strong>method</strong> (<em>interpolate</em>) &#8211; how to generate random tads (alternative is
&#8216;shuffle&#8217;). &#8216;interpolate&#8217; will calculate the distribution of TAD lengths,
and generate a random set of TADs according to this distribution (see
<a class="reference internal" href="#pytadbit.alignment.generate_rnd_tads" title="pytadbit.alignment.generate_rnd_tads"><tt class="xref py py-func docutils literal"><span class="pre">pytadbit.alignment.generate_rnd_tads()</span></tt></a>). In contrast, the &#8216;shuffle&#8217;
method uses directly the set of observed TADs and shuffle them (see
<a class="reference internal" href="#pytadbit.alignment.generate_shuffle_tads" title="pytadbit.alignment.generate_shuffle_tads"><tt class="xref py py-func docutils literal"><span class="pre">pytadbit.alignment.generate_shuffle_tads()</span></tt></a>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytadbit.alignment.generate_rnd_tads">
<tt class="descclassname">pytadbit.alignment.</tt><tt class="descname">generate_rnd_tads</tt><big>(</big><em>chromosome_len</em>, <em>distr</em>, <em>start=0</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#generate_rnd_tads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.generate_rnd_tads" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates random TADs over a chromosome of a given size according to a given
distribution of lengths of TADs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chromosome_len</strong> &#8211; length of the chromosome</li>
<li><strong>distr</strong> &#8211; function that returns a TAD length depending on a p value</li>
<li><strong>bin_size</strong> &#8211; size of the bin of the Hi-C experiment</li>
<li><strong>start</strong> (<em>0</em>) &#8211; starting position in the chromosome</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of TADs</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pytadbit.alignment.generate_shuffle_tads">
<tt class="descclassname">pytadbit.alignment.</tt><tt class="descname">generate_shuffle_tads</tt><big>(</big><em>tads</em><big>)</big><a class="reference internal" href="../modules/pytadbit/alignment.html#generate_shuffle_tads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pytadbit.alignment.generate_shuffle_tads" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shuffle version of a given list of TADs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tads</strong> &#8211; list of TADs</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of shuffled TADs</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing TADBit on GNU/Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Reference Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reference_chromosome.html">Chromosome class</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_experiment.html">Experiment class</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_tadbit.html">Tadbit functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_clustering.html">TAD clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_parser.html">Parsers</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_aligner.html">Boundary Aligner</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Alignment class</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_imp.html">Generate a 3D models</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../biblio.html">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reference_aligner.html"
                        title="previous chapter">Boundary Aligner</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference_imp.html"
                        title="next chapter">Generate a 3D models</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="reference_imp.html" title="Generate a 3D models"
             >next</a> |</li>
        <li class="right" >
          <a href="reference_aligner.html" title="Boundary Aligner"
             >previous</a> |</li>
        <li><a href="../index.html">Tadbit 0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" >Reference Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright .
      Last updated on Nov 06, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>